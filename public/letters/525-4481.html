<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="5/25">
  <title>5/25 - Thank You Notes</title>
  <link rel="manifest" href="/letters/manifest.json">
  <meta name="theme-color" content="#007bff">
  <link rel="apple-touch-icon" href="/letters/icon-192.png">
  <style>
    /**
 * Shared Styles for Thank You Notes
 * Used by both the static site and PWA version
 */

/* Base Reset and Layout */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  background: #f5f5f5;
  color: #333;
  line-height: 1.6;
}

.container {
  max-width: 900px;
  margin: 0 auto;
  padding: 2rem 1rem;
}

/* Loading and Error States */
.loading,
.error {
  text-align: center;
  padding: 3rem;
  font-size: 1.2rem;
}

.error {
  color: #dc3545;
}

/* Header */
.header {
  margin-bottom: 1.5rem;
  text-align: center;
}

.header h1 {
  font-size: 2.5rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  color: #1a1a1a;
}

.subtitle {
  font-size: 1rem;
  color: #666;
}

/* Controls */
.controls {
  margin-bottom: 2rem;
}

.search-container {
  position: relative;
  margin-bottom: 1rem;
}

.search-input {
  width: 100%;
  padding: 0.75rem 2.5rem 0.75rem 1rem;
  font-size: 1rem;
  border: 2px solid #dee2e6;
  border-radius: 8px;
  outline: none;
  transition: border-color 0.2s;
  background: white;
}

.search-input:focus {
  border-color: #007bff;
}

.clear-search {
  position: absolute;
  right: 0.75rem;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  font-size: 1.25rem;
  color: #6c757d;
  cursor: pointer;
  padding: 0.25rem 0.5rem;
  line-height: 1;
  transition: color 0.2s;
}

.clear-search:hover {
  color: #333;
}

.control-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 1rem;
  flex-wrap: wrap;
}

.sort-container {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.sort-container label {
  font-size: 0.875rem;
  font-weight: 500;
  color: #666;
}

.sort-select {
  padding: 0.5rem 0.75rem;
  font-size: 0.875rem;
  border: 2px solid #dee2e6;
  border-radius: 6px;
  background: white;
  cursor: pointer;
  outline: none;
  transition: border-color 0.2s;
}

.sort-select:focus {
  border-color: #007bff;
}

.result-count {
  font-size: 0.875rem;
  font-weight: 600;
  color: #495057;
  padding: 0.5rem 0.75rem;
  background: #e9ecef;
  border-radius: 6px;
  white-space: nowrap;
}

.btn-random {
  background: #28a745;
  color: white;
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 6px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
  white-space: nowrap;
}

.btn-random:hover {
  background: #218838;
  transform: translateY(-1px);
}

.btn-random:active {
  transform: translateY(0);
}

.searching,
.no-results {
  text-align: center;
  padding: 3rem 1rem;
  font-size: 1.1rem;
  color: #666;
}

/* Email/Letter List */
.list,
.letter-list {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

.email-card,
.letter-card {
  background: white;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  cursor: pointer;
  transition: transform 0.2s, box-shadow 0.2s;
  text-decoration: none;
  color: inherit;
  display: block;
}

.email-card:hover,
.letter-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.email-card-image {
  width: 100%;
  height: 200px;
  overflow: hidden;
  background: #e9ecef;
}

.email-card-image img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.email-card-content,
.letter-card {
  padding: 1.5rem;
}

.email-card h2,
.letter-card h2 {
  font-size: 1.5rem;
  margin-bottom: 0.5rem;
  color: #1a1a1a;
  font-weight: 600;
}

.email-description,
.letter-card p {
  color: #666;
  margin-bottom: 0.75rem;
  line-height: 1.5;
}

.email-search-snippet {
  color: #555;
  margin-bottom: 0.75rem;
  line-height: 1.5;
  font-style: italic;
}

.search-highlight {
  background: #fff3cd;
  color: #856404;
  font-weight: 700;
  padding: 0.1rem 0.2rem;
  border-radius: 3px;
  font-style: normal;
}

.email-date,
.letter-card time {
  display: block;
  font-size: 0.875rem;
  color: #888;
}

/* Email/Letter Reader */
.email-reader,
.letter-content {
  background: white;
  border-radius: 8px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  overflow: hidden;
  margin-bottom: 2rem;
}

.email-reader {
  touch-action: pan-y pinch-zoom;
}

.reader-nav,
.navigation {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem 1.5rem;
  background: #f8f9fa;
  border-bottom: 1px solid #dee2e6;
  gap: 1rem;
  flex-wrap: wrap;
}

.reader-nav-bottom {
  border-top: 1px solid #dee2e6;
  border-bottom: none;
}

.nav-buttons,
.nav-links {
  display: flex;
  gap: 0.5rem;
  flex-wrap: wrap;
}

/* Buttons */
.btn {
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
  text-decoration: none;
  display: inline-block;
}

.btn:hover {
  transform: translateY(-1px);
}

.btn:active {
  transform: translateY(0);
}

.btn-secondary {
  background: #6c757d;
  color: white;
}

.btn-secondary:hover {
  background: #5a6268;
}

.btn-nav {
  background: #007bff;
  color: white;
}

.btn-nav:hover {
  background: #0056b3;
}

.btn-back-arrow {
  background: none;
  border: none;
  color: #333;
  cursor: pointer;
  padding: 0.25rem 0.5rem;
  transition: color 0.2s, transform 0.1s;
  line-height: 1;
}

.btn-back-arrow:hover {
  color: #007bff;
  transform: translateX(-2px);
}

.btn-back-arrow:active {
  transform: translateX(0);
}

/* Email/Letter Content */
.email-content,
.letter-content {
  padding: 2rem 1.5rem;
}

.email-header,
.letter-header {
  margin-bottom: 2rem;
  padding-bottom: 1.5rem;
  border-bottom: 2px solid #e9ecef;
}

.email-header h1,
.letter-header h1 {
  font-size: 2rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  color: #1a1a1a;
  line-height: 1.3;
}

.email-header .email-date,
.letter-header time {
  font-size: 1rem;
  color: #666;
}

/* Email/Letter Body Styles */
.email-body,
.letter-body {
  font-size: 1.0625rem;
  line-height: 1.7;
  color: #333;
}

.email-body h1,
.email-body h2,
.email-body h3,
.email-body h4,
.email-body h5,
.email-body h6,
.letter-body h1,
.letter-body h2,
.letter-body h3,
.letter-body h4,
.letter-body h5,
.letter-body h6 {
  margin-top: 1.5rem;
  margin-bottom: 0.75rem;
  font-weight: 600;
  color: #1a1a1a;
  line-height: 1.3;
}

.email-body h1,
.letter-body h1 {
  font-size: 1.875rem;
}

.email-body h2,
.letter-body h2 {
  font-size: 1.5rem;
}

.email-body h3,
.letter-body h3 {
  font-size: 1.25rem;
}

.email-body p,
.letter-body p {
  margin-bottom: 1rem;
}

.email-body a,
.letter-body a {
  color: #007bff;
  text-decoration: none;
}

.email-body a:hover,
.letter-body a:hover {
  text-decoration: underline;
}

.email-body img,
.letter-body img {
  max-width: 100%;
  height: auto;
  border-radius: 4px;
  margin: 1.5rem 0;
}

.email-body ul,
.email-body ol,
.letter-body ul,
.letter-body ol {
  margin-bottom: 1rem;
  padding-left: 2rem;
}

.email-body li,
.letter-body li {
  margin-bottom: 0.5rem;
}

.email-body blockquote,
.letter-body blockquote {
  margin: 1.5rem 0;
  padding-left: 1rem;
  border-left: 4px solid #e9ecef;
  color: #666;
  font-style: italic;
}

.email-body code,
.letter-body code {
  background: #f8f9fa;
  padding: 0.2rem 0.4rem;
  border-radius: 3px;
  font-family: 'Courier New', monospace;
  font-size: 0.9em;
}

.email-body pre,
.letter-body pre {
  background: #f8f9fa;
  padding: 1rem;
  border-radius: 4px;
  overflow-x: auto;
  margin: 1.5rem 0;
}

.email-body pre code,
.letter-body pre code {
  background: none;
  padding: 0;
}

.email-body hr,
.letter-body hr {
  border: none;
  border-top: 2px solid #e9ecef;
  margin: 2rem 0;
}

/* PWA Banner */
.pwa-banner {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 1rem;
  border-radius: 8px;
  margin: 1rem 0 2rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 1rem;
  flex-wrap: wrap;
}

.pwa-banner-text {
  flex: 1;
  min-width: 200px;
}

.pwa-banner-text h3 {
  margin-bottom: 0.25rem;
  font-size: 1.1rem;
}

.pwa-banner-text p {
  font-size: 0.9rem;
  opacity: 0.9;
}

.btn-primary {
  background: #007bff;
  color: white;
  padding: 0.75rem 1.25rem;
  border: none;
  border-radius: 6px;
  font-size: 0.9375rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
}

.btn-primary:hover {
  background: #0056b3;
  transform: translateY(-1px);
}

.btn-primary:active {
  transform: translateY(0);
}

.btn-primary:disabled {
  background: #6c757d;
  cursor: not-allowed;
  transform: none;
}

.btn-danger {
  background: #dc3545;
  color: white;
  padding: 0.75rem 1.25rem;
  border: none;
  border-radius: 6px;
  font-size: 0.9375rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
}

.btn-danger:hover {
  background: #c82333;
  transform: translateY(-1px);
}

.btn-danger:active {
  transform: translateY(0);
}

/* Offline & PWA UI */
.offline-banner {
  background: #ff9800;
  color: white;
  padding: 0.75rem 1rem;
  text-align: center;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-weight: 500;
}

.download-progress {
  background: white;
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.download-progress-bar {
  height: 8px;
  background: #e9ecef;
  border-radius: 4px;
  overflow: hidden;
  margin-bottom: 0.5rem;
}

.download-progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #007bff, #0056b3);
  transition: width 0.3s ease;
}

.download-progress p {
  font-size: 0.875rem;
  color: #666;
  text-align: center;
  margin: 0;
}

.btn-offline {
  background: #6c757d;
  color: white;
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 6px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
  white-space: nowrap;
}

.btn-offline:hover {
  background: #5a6268;
  transform: translateY(-1px);
}

.btn-offline:active {
  transform: translateY(0);
}

.offline-panel {
  background: white;
  padding: 1.5rem;
  border-radius: 8px;
  margin-bottom: 1.5rem;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.offline-panel h3 {
  margin-bottom: 1rem;
  color: #1a1a1a;
  font-size: 1.25rem;
}

.offline-stats {
  background: #f8f9fa;
  padding: 1rem;
  border-radius: 6px;
  margin-bottom: 1rem;
}

.offline-stats p {
  margin: 0.5rem 0;
  color: #495057;
  font-size: 0.9375rem;
}

.offline-actions {
  display: flex;
  gap: 0.75rem;
  margin-bottom: 1rem;
  flex-wrap: wrap;
}

.offline-note {
  font-size: 0.875rem;
  color: #666;
  line-height: 1.5;
  margin: 0;
  font-style: italic;
}

/* Responsive Design */
@media (max-width: 768px) {
  .container {
    padding: 1rem 0.5rem;
  }

  .header h1 {
    font-size: 2rem;
  }

  .control-row {
    flex-direction: column;
    align-items: stretch;
  }

  .sort-container {
    width: 100%;
    justify-content: space-between;
  }

  .sort-select {
    flex: 1;
  }

  .result-count {
    text-align: center;
  }

  .btn-random {
    width: 100%;
  }

  .email-card-content {
    padding: 1rem;
  }

  .email-card h2 {
    font-size: 1.25rem;
  }

  .email-content,
  .letter-content {
    padding: 1.5rem 1rem;
  }

  .email-header h1,
  .letter-header h1 {
    font-size: 1.5rem;
  }

  .reader-nav,
  .navigation {
    flex-direction: column;
    align-items: stretch;
  }

  .nav-buttons,
  .nav-links {
    flex-direction: column;
  }

  .btn {
    width: 100%;
    text-align: center;
  }

  .btn-nav {
    font-size: 0.8125rem;
    white-space: normal;
    word-wrap: break-word;
  }

  body {
    padding: 10px;
  }

  .pwa-banner {
    flex-direction: column;
    text-align: center;
  }
}

@media (max-width: 480px) {
  .email-card-image {
    height: 150px;
  }

  .email-body,
  .letter-body {
    font-size: 1rem;
  }
}


    
    /* Static site specific adjustments */
    body {
      padding: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    
    <div class="pwa-banner" style="display: none;">
      <div class="pwa-banner-text">
        <h3>📱 Read Offline</h3>
        <p>Install the app to read all letters offline</p>
      </div>
      <div>
        <button class="btn btn-primary" onclick="installPWA()">Install App</button>
      </div>
    </div>

    <article class="letter-content">
      <header class="letter-header">
        <h1>5/25</h1>
        <time datetime="2018-05-25T00:00:00Z">May 24, 2018</time>
      </header>

      <div class="letter-body">
        <p>i&#39;m thankful that i got through yesterday even though it was very hard and i felt bad all day, worse than yesterday and the day before. i&#39;m thankful last night to have finally broken down called my psychiatrist&#39;s office and left a voicemail and told them i cannot ride this out and wait until my next appointment and need to be back on some kind of SSRI as soon as possible because whatever side effects or lack of primary effects i was having on them, the way i feel now is so much more dramatically worse than how i did before. i&#39;m thankful that i made this call even though it felt so dramatic and goes against my normal status as a people pleaser and i have never called in between appointments like this, even though that&#39;s stupid because the point of me seeing the psychiatrist is to help with my mental health and even though she says at every appointment that i should feel free to call her office in between appointments if i&#39;m having issues. i&#39;m thankful to have carefully spelled my last name and enunciated my phone number and date of birth.</p>
<p>i&#39;m thankful in the message to have asked that unless she has a firmer position about a new drug to try (since it seems like we have been running out of options) that she consider putting me back on prozac or zoloft, two drugs that i stopped taking not because of side effects but because they weren&#39;t <em>as</em> effective as i wanted them to be, which is why i went off them and on to other things, even though in retrospect &quot;not as effective as i want them to be&quot; seems like an impossibly great position after days spent vibrating with fear and stress and self-hate and bad feelings, not sleeping much, all my muscles clenched and pulsing. i&#39;m thankful that though in my mind i have been castigating myself for stopping taking those medications when they were working some in order to try other things because i &quot;got greedy,&quot; as if wanting to have better mental health is a matter of greed, i know that&#39;s bullshit, but i&#39;m also thankful to try to capture how fucking terrible i feel right now in words so that later when i don&#39;t feel like this (i&#39;m thankful that i am still hopeful that there will be a later when i don&#39;t feel like this) ___PARAGRAPH_BREAK___</p>
<p>i&#39;m thankful to have just enough perspective to realize that all of the negative self-talk that has been playing constantly in my internal monologue the past week is a clear sign that something is wrong with me, since normally despite my anxiety i am a fucking obnoxious textbook scorpio who thinks he is good at everything he wants to be good at and puts his mind to and yet this week even simple things that i do all the time and definitely am good at have been accompanied in my mind by an endless chorus of me telling myself &quot;you&#39;re incompetent, you&#39;re stupid, other people are so much better than you, wow, how can you not do this simple thing, god, you&#39;ve really lost your skills, haven&#39;t you&quot; and i&#39;m thankful i know that is NOT REAL, but however much i know intellectually it isn&#39;t real and however much other people are telling me &quot;justin, you&#39;re awesome, you&#39;re doing a great job, you&#39;re so smart&quot; which they are, because i have kind and good people in my life who appreciate me, to know that i cannot by sheer force of will make myself stop feeling and thinking this way because i have been trying that as hard as i can and it is not working and making me feel sick.</p>
<p>i&#39;m thankful still to try, to write down some things that were good this week to try to play back against the tape loop of self-hatred even though in my mind this week is a hieronymus bosch painting. i&#39;m thankful that i wrote good reproduction instructions for a tricky bug. i&#39;m thankful that i helped one coworker build a slash command slack bot which she thought she wasn&#39;t capable of doing but she was actually totally capable of doing. i&#39;m thankful to have watched and given support and helpful feedback on the presentation another coworker is trying to do to move into a higher level position. i&#39;m thankful to have given a workshop to another about http requests that she said demystified them and made her feel more confident in experimenting and trying things she wanted to try out. i&#39;m thankful in one of my projects to have figured out how to and started setting up some complex message passing between three levels of execution context in the chrome extension i am building. i&#39;m thankful to have immediately and profusely apologized for a remark i made to a person at work who i deeply respect and whose opinion of me is very important but to whom i made a comment that seemed, despite my intentions, like a criticism of her work. i&#39;m thankful that despite feeling &quot;stupid&quot; and &quot;unproductive,&quot; i have helped many of my company&#39;s customers with their problems and done so in a friendly and encouraging way and i&#39;m thankful that some of them appreciate that. i&#39;m thankful to remind myself that all of things i am telling myself i can&#39;t do are things that i can do and have been doing all along, that i am good at teaching and learning and problem solving and reading and writing.</p>
<p>i&#39;m thankful that there are things i can to not feel sick, or at least to try to feel less sick. i&#39;m thankful that though meditation is not working now and puts me in an even darker and more isolated place, yoga is good and i can do that to stretch out the clenches i have been stressing into my body and keep my energy flowing.  i&#39;m thankful that i know i have not been eating enough during the day and that i need to force myself to do so even if i don&#39;t want to and things don&#39;t appeal to me because hunger can only be exacerbating these bad feelings. i&#39;m thankful that i can and should force myself to take my lunch break in the middle of the day when i should be taking my lunch rather than putting it off later and later to chase the nebulous and fleeting dragon of productivity and ending up, as i did yesterday, still not having had lunch at 3:30 and then feeling like &quot;well, what&#39;s the point, it&#39;ll be dinner in a couple of hours anyway.&quot; i&#39;m thankful to point out to my dumbass internal monologue that there is a point, which is that when your body is hungry if you eat food you will not be as hungry and that is a good thing. i&#39;m thankful to call myself a dumbass like i did in the last sentence because it feels good to use that word but i&#39;m also thankful that last week or the week before in slack, trying to share something i had learned with my coworkers, i wrote &quot;if you are an idiot like me, you may not have realized [x]&quot; and repeatedly used the construction &quot;if you are an idiot like me, which i thought was funny and self deprecating at the time but now seems like a looming sign of the negative self talk to come and i&#39;m thankful that one of them responded &quot;don&#39;t talk that way about my friend&quot; (i.e. don&#39;t call yourself an idiot).</p>
<p>i&#39;m thankful that i did not beat myself up too much because i did not get our planned dinner prepped and ready last night (even though that too felt like yet another small failure in a litany of them) and that d was not upset either and we went to the wendy&#39;s drive through and got cheeseburgers and fries and chocolate frosties and ate them on the floor watching TV. i&#39;m thankful that after dinner, we unpacked the big full length mirror d ordered to put in her office to help reflect light and make it feel like her one window is brighter. i&#39;m thankful that it felt so sadly appropriate when, after dragging the big box into her office and opening it up and then peeling back all the layers of bubble wrap and styrofoam inside, that the mirror was cracked, and not just a little cosmetic scratch one might ignore but deeply and all over the surface, and would have to be sent back. i&#39;m thankful that though it sucked it felt like such an appropriate capper to the day that it kind of made me laugh in spite of myself, which was a nice feeling. i&#39;m thankful for the chocolate frosty i had after, which, at the drive through after we ordered i thought &quot;oh, maybe i should have ordered a medium, a small is so dainty,&quot; but that a small was actually the right amount and actually maybe even more than i needed because a frostie is so dense and rich. i&#39;m thankful to have had a really nice DM conversation with s where she &quot;<a href="https://www.youtube.com/watch?v=6Whgn_iE5uc">smooth</a>&quot;-rolled me and then we told each other how much we value our friendship.</p>
<p>i&#39;m thankful that at a certain point in the evening i was in the bedroom and d was in the living room and she emailed me to let me know she had changed the password for our account with the power company and i realized that she has been singlehandedly paying the power bill, which used to be one of my jobs, for the last year since we moved in and billing me for it and i have not noticed this labor at all, have not once thought about the power bill or and just taken the fact that we have continued to have the light and heat and air conditioning and electricity and water we need for granted and i&#39;m thankful to have immediately thanked her for that. i&#39;m thankful that a bit later, after i finally broke down and called the psychiatrist&#39;s office (which she had been gently suggesting to me for several days but without forcing me or insisting) she came to the bedroom for the evening (even though she doesn&#39;t normally like going to bed as early as i do) and comforted me. </p>
<p>i&#39;m thankful that while we each played simple numbing calming video games on our respective sides of the bed, i played <a href="https://www.earwolf.com/show/u-talkin-u2-to-me/">ru talking rem re: me</a>, which is my favorite silly podcast, and d laughed along even though it is not her favorite podcast, and they played a clip of &quot;everybody hurts&quot; for some bit or another, and i was reminded of how in college one of my roomates z did this thing where if i felt bad and closed myself up in my room and didn&#39;t hang out with him or anyone else, which i did often enough that my friend group had a nickname for it (&quot;the void&quot;) and which in retrospect seems like a clear sign of depression but then i thought at the time that that was a thing that happened to other people and not me, which is that he would play the song &quot;<a href="https://www.earwolf.com/show/u-talkin-u2-to-me/">everybody hurts</a>&quot; very very loud on the stereo in our living room on loop until i came out to play mario kart or go to qdoba or whatever else college activity we had planned. i&#39;m thankful that though i found that extremely fucking obnoxious at the time and hated him for it and still do not think it is, like, a good mental health treatment modality, that use of that song is so big and silly and obvious that thinking about it right now is kind of making me smile, which i am grateful for, and reminding me that the way i feel now is a way i have felt many times before, to some degree or another, and that it will pass. i&#39;m thankful for the reassurance of that, and of the song, that everybody hurts sometimes and i am not alone.</p>

      </div>
    </article>

    <nav class="navigation">
      <a href="/letters/" class="btn btn-secondary">home</a>
      <div class="nav-links">
        <a href="/letters/letters/526.html" class="btn btn-secondary">← 5/26</a>
        <a href="/letters/letters/vic2.html" class="btn btn-secondary">Vic(2) →</a>
      </div>
    </nav>
  
  </div>

  <script>
    // PWA installation prompt
    let deferredPrompt;

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      
      const banner = document.querySelector('.pwa-banner');
      if (banner) {
        banner.style.display = 'flex';
      }
    });

    async function installPWA() {
      if (!deferredPrompt) {
        // If not installable, redirect to PWA
        window.location.href = '/letters/app/';
        return;
      }

      deferredPrompt.prompt();
      const { outcome } = await deferredPrompt.userChoice;
      
      if (outcome === 'accepted') {
        console.log('PWA installed');
      }
      
      deferredPrompt = null;
      const banner = document.querySelector('.pwa-banner');
      if (banner) {
        banner.style.display = 'none';
      }
    }

    function openPWA() {
      window.location.href = '/letters/app/';
    }

    // Progressive Enhancement: Check if user has PWA installed
    // If they do, redirect them to the app version for a richer experience
    if (window.matchMedia('(display-mode: standalone)').matches) {
      // User is in standalone mode (PWA is installed and running)
      // Keep them on static page - they're already in PWA mode
      console.log('Running in PWA mode');
    } else {
      // Check if user has previously used the PWA (has cached data)
      if ('caches' in window) {
        caches.keys().then(cacheNames => {
          const hasPWACache = cacheNames.some(name => 
            name.includes('static-') || name.includes('data-')
          );
          
          // Only show PWA banner if they have cached content
          if (hasPWACache) {
            const banner = document.querySelector('.pwa-banner');
            if (banner && banner.style.display === 'none') {
              banner.style.display = 'flex';
            }
          }
        });
      }
    }

    // Register service worker for all pages
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker
          .register('/letters/sw.js', { scope: '/letters/' })
          .then((registration) => {
            console.log('SW registered:', registration);
          })
          .catch((error) => {
            console.log('SW registration failed:', error);
          });
      });
    }
  </script>
</body>
</html>