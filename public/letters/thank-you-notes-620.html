<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="thank you notes 6/20">
  <title>thank you notes 6/20 - Thank You Notes</title>
  <link rel="manifest" href="/letters/manifest.json">
  <meta name="theme-color" content="#007bff">
  <link rel="apple-touch-icon" href="/letters/icon-192.png">
  <style>
    /**
 * Shared Styles for Thank You Notes
 * Used by both the static site and PWA version
 */

/* Base Reset and Layout */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  background: #f5f5f5;
  color: #333;
  line-height: 1.6;
}

.container {
  max-width: 900px;
  margin: 0 auto;
  padding: 2rem 1rem;
}

/* Loading and Error States */
.loading,
.error {
  text-align: center;
  padding: 3rem;
  font-size: 1.2rem;
}

.error {
  color: #dc3545;
}

/* Header */
.header {
  margin-bottom: 1.5rem;
  text-align: center;
}

.header h1 {
  font-size: 2.5rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  color: #1a1a1a;
}

.subtitle {
  font-size: 1rem;
  color: #666;
}

/* Controls */
.controls {
  margin-bottom: 2rem;
}

.search-container {
  position: relative;
  margin-bottom: 1rem;
}

.search-input {
  width: 100%;
  padding: 0.75rem 2.5rem 0.75rem 1rem;
  font-size: 1rem;
  border: 2px solid #dee2e6;
  border-radius: 8px;
  outline: none;
  transition: border-color 0.2s;
  background: white;
}

.search-input:focus {
  border-color: #007bff;
}

.clear-search {
  position: absolute;
  right: 0.75rem;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  font-size: 1.25rem;
  color: #6c757d;
  cursor: pointer;
  padding: 0.25rem 0.5rem;
  line-height: 1;
  transition: color 0.2s;
}

.clear-search:hover {
  color: #333;
}

.control-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 1rem;
  flex-wrap: wrap;
}

.sort-container {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.sort-container label {
  font-size: 0.875rem;
  font-weight: 500;
  color: #666;
}

.sort-select {
  padding: 0.5rem 0.75rem;
  font-size: 0.875rem;
  border: 2px solid #dee2e6;
  border-radius: 6px;
  background: white;
  cursor: pointer;
  outline: none;
  transition: border-color 0.2s;
}

.sort-select:focus {
  border-color: #007bff;
}

.result-count {
  font-size: 0.875rem;
  font-weight: 600;
  color: #495057;
  padding: 0.5rem 0.75rem;
  background: #e9ecef;
  border-radius: 6px;
  white-space: nowrap;
}

.btn-random {
  background: #28a745;
  color: white;
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 6px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
  white-space: nowrap;
}

.btn-random:hover {
  background: #218838;
  transform: translateY(-1px);
}

.btn-random:active {
  transform: translateY(0);
}

.searching,
.no-results {
  text-align: center;
  padding: 3rem 1rem;
  font-size: 1.1rem;
  color: #666;
}

/* Email/Letter List */
.list,
.letter-list {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

.email-card,
.letter-card {
  background: white;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  cursor: pointer;
  transition: transform 0.2s, box-shadow 0.2s;
  text-decoration: none;
  color: inherit;
  display: block;
}

.email-card:hover,
.letter-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.email-card-image {
  width: 100%;
  height: 200px;
  overflow: hidden;
  background: #e9ecef;
}

.email-card-image img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.email-card-content,
.letter-card {
  padding: 1.5rem;
}

.email-card h2,
.letter-card h2 {
  font-size: 1.5rem;
  margin-bottom: 0.5rem;
  color: #1a1a1a;
  font-weight: 600;
}

.email-description,
.letter-card p {
  color: #666;
  margin-bottom: 0.75rem;
  line-height: 1.5;
}

.email-search-snippet {
  color: #555;
  margin-bottom: 0.75rem;
  line-height: 1.5;
  font-style: italic;
}

.search-highlight {
  background: #fff3cd;
  color: #856404;
  font-weight: 700;
  padding: 0.1rem 0.2rem;
  border-radius: 3px;
  font-style: normal;
}

.email-date,
.letter-card time {
  display: block;
  font-size: 0.875rem;
  color: #888;
}

/* Email/Letter Reader */
.email-reader,
.letter-content {
  background: white;
  border-radius: 8px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  overflow: hidden;
  margin-bottom: 2rem;
}

.email-reader {
  touch-action: pan-y pinch-zoom;
}

.reader-nav,
.navigation {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem 1.5rem;
  background: #f8f9fa;
  border-bottom: 1px solid #dee2e6;
  gap: 1rem;
  flex-wrap: wrap;
}

.reader-nav-bottom {
  border-top: 1px solid #dee2e6;
  border-bottom: none;
}

.nav-buttons,
.nav-links {
  display: flex;
  gap: 0.5rem;
  flex-wrap: wrap;
}

/* Buttons */
.btn {
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
  text-decoration: none;
  display: inline-block;
}

.btn:hover {
  transform: translateY(-1px);
}

.btn:active {
  transform: translateY(0);
}

.btn-secondary {
  background: #6c757d;
  color: white;
}

.btn-secondary:hover {
  background: #5a6268;
}

.btn-nav {
  background: #007bff;
  color: white;
}

.btn-nav:hover {
  background: #0056b3;
}

.btn-back-arrow {
  background: none;
  border: none;
  color: #333;
  cursor: pointer;
  padding: 0.25rem 0.5rem;
  transition: color 0.2s, transform 0.1s;
  line-height: 1;
}

.btn-back-arrow:hover {
  color: #007bff;
  transform: translateX(-2px);
}

.btn-back-arrow:active {
  transform: translateX(0);
}

/* Email/Letter Content */
.email-content,
.letter-content {
  padding: 2rem 1.5rem;
}

.email-header,
.letter-header {
  margin-bottom: 2rem;
  padding-bottom: 1.5rem;
  border-bottom: 2px solid #e9ecef;
}

.email-header h1,
.letter-header h1 {
  font-size: 2rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  color: #1a1a1a;
  line-height: 1.3;
}

.email-header .email-date,
.letter-header time {
  font-size: 1rem;
  color: #666;
}

/* Email/Letter Body Styles */
.email-body,
.letter-body {
  font-size: 1.0625rem;
  line-height: 1.7;
  color: #333;
}

.email-body h1,
.email-body h2,
.email-body h3,
.email-body h4,
.email-body h5,
.email-body h6,
.letter-body h1,
.letter-body h2,
.letter-body h3,
.letter-body h4,
.letter-body h5,
.letter-body h6 {
  margin-top: 1.5rem;
  margin-bottom: 0.75rem;
  font-weight: 600;
  color: #1a1a1a;
  line-height: 1.3;
}

.email-body h1,
.letter-body h1 {
  font-size: 1.875rem;
}

.email-body h2,
.letter-body h2 {
  font-size: 1.5rem;
}

.email-body h3,
.letter-body h3 {
  font-size: 1.25rem;
}

.email-body p,
.letter-body p {
  margin-bottom: 1rem;
}

.email-body a,
.letter-body a {
  color: #007bff;
  text-decoration: none;
}

.email-body a:hover,
.letter-body a:hover {
  text-decoration: underline;
}

.email-body img,
.letter-body img {
  max-width: 100%;
  height: auto;
  border-radius: 4px;
  margin: 1.5rem 0;
}

.email-body ul,
.email-body ol,
.letter-body ul,
.letter-body ol {
  margin-bottom: 1rem;
  padding-left: 2rem;
}

.email-body li,
.letter-body li {
  margin-bottom: 0.5rem;
}

.email-body blockquote,
.letter-body blockquote {
  margin: 1.5rem 0;
  padding-left: 1rem;
  border-left: 4px solid #e9ecef;
  color: #666;
  font-style: italic;
}

.email-body code,
.letter-body code {
  background: #f8f9fa;
  padding: 0.2rem 0.4rem;
  border-radius: 3px;
  font-family: 'Courier New', monospace;
  font-size: 0.9em;
}

.email-body pre,
.letter-body pre {
  background: #f8f9fa;
  padding: 1rem;
  border-radius: 4px;
  overflow-x: auto;
  margin: 1.5rem 0;
}

.email-body pre code,
.letter-body pre code {
  background: none;
  padding: 0;
}

.email-body hr,
.letter-body hr {
  border: none;
  border-top: 2px solid #e9ecef;
  margin: 2rem 0;
}

/* PWA Banner */
.pwa-banner {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 1rem;
  border-radius: 8px;
  margin: 1rem 0 2rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 1rem;
  flex-wrap: wrap;
}

.pwa-banner-text {
  flex: 1;
  min-width: 200px;
}

.pwa-banner-text h3 {
  margin-bottom: 0.25rem;
  font-size: 1.1rem;
}

.pwa-banner-text p {
  font-size: 0.9rem;
  opacity: 0.9;
}

.btn-primary {
  background: #007bff;
  color: white;
  padding: 0.75rem 1.25rem;
  border: none;
  border-radius: 6px;
  font-size: 0.9375rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
}

.btn-primary:hover {
  background: #0056b3;
  transform: translateY(-1px);
}

.btn-primary:active {
  transform: translateY(0);
}

.btn-primary:disabled {
  background: #6c757d;
  cursor: not-allowed;
  transform: none;
}

.btn-danger {
  background: #dc3545;
  color: white;
  padding: 0.75rem 1.25rem;
  border: none;
  border-radius: 6px;
  font-size: 0.9375rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
}

.btn-danger:hover {
  background: #c82333;
  transform: translateY(-1px);
}

.btn-danger:active {
  transform: translateY(0);
}

/* Offline & PWA UI */
.offline-banner {
  background: #ff9800;
  color: white;
  padding: 0.75rem 1rem;
  text-align: center;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-weight: 500;
}

.download-progress {
  background: white;
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.download-progress-bar {
  height: 8px;
  background: #e9ecef;
  border-radius: 4px;
  overflow: hidden;
  margin-bottom: 0.5rem;
}

.download-progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #007bff, #0056b3);
  transition: width 0.3s ease;
}

.download-progress p {
  font-size: 0.875rem;
  color: #666;
  text-align: center;
  margin: 0;
}

.btn-offline {
  background: #6c757d;
  color: white;
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 6px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
  white-space: nowrap;
}

.btn-offline:hover {
  background: #5a6268;
  transform: translateY(-1px);
}

.btn-offline:active {
  transform: translateY(0);
}

.offline-panel {
  background: white;
  padding: 1.5rem;
  border-radius: 8px;
  margin-bottom: 1.5rem;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.offline-panel h3 {
  margin-bottom: 1rem;
  color: #1a1a1a;
  font-size: 1.25rem;
}

.offline-stats {
  background: #f8f9fa;
  padding: 1rem;
  border-radius: 6px;
  margin-bottom: 1rem;
}

.offline-stats p {
  margin: 0.5rem 0;
  color: #495057;
  font-size: 0.9375rem;
}

.offline-actions {
  display: flex;
  gap: 0.75rem;
  margin-bottom: 1rem;
  flex-wrap: wrap;
}

.offline-note {
  font-size: 0.875rem;
  color: #666;
  line-height: 1.5;
  margin: 0;
  font-style: italic;
}

/* Responsive Design */
@media (max-width: 768px) {
  .container {
    padding: 1rem 0.5rem;
  }

  .header h1 {
    font-size: 2rem;
  }

  .control-row {
    flex-direction: column;
    align-items: stretch;
  }

  .sort-container {
    width: 100%;
    justify-content: space-between;
  }

  .sort-select {
    flex: 1;
  }

  .result-count {
    text-align: center;
  }

  .btn-random {
    width: 100%;
  }

  .email-card-content {
    padding: 1rem;
  }

  .email-card h2 {
    font-size: 1.25rem;
  }

  .email-content,
  .letter-content {
    padding: 1.5rem 1rem;
  }

  .email-header h1,
  .letter-header h1 {
    font-size: 1.5rem;
  }

  .reader-nav,
  .navigation {
    flex-direction: column;
    align-items: stretch;
  }

  .nav-buttons,
  .nav-links {
    flex-direction: column;
  }

  .btn {
    width: 100%;
    text-align: center;
  }

  .btn-nav {
    font-size: 0.8125rem;
    white-space: normal;
    word-wrap: break-word;
  }

  body {
    padding: 10px;
  }

  .pwa-banner {
    flex-direction: column;
    text-align: center;
  }
}

@media (max-width: 480px) {
  .email-card-image {
    height: 150px;
  }

  .email-body,
  .letter-body {
    font-size: 1rem;
  }
}

    
    /* Static site specific adjustments */
    body {
      padding: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    
    <div class="pwa-banner" style="display: none;">
      <div class="pwa-banner-text">
        <h3>📱 Read Offline</h3>
        <p>Install the app to read all letters offline</p>
      </div>
      <div>
        <button class="btn btn-primary" onclick="installPWA()">Install App</button>
      </div>
    </div>

    <article class="letter-content">
      <header class="letter-header">
        <h1>thank you notes 6/20</h1>
        <time datetime="2016-06-20T00:00:00Z">June 19, 2016</time>
      </header>

      <div class="letter-body">
        <p>i&#39;m thankful to have recently watched <em>midnight special</em> and rewatched <em>interstellar</em>, both of which are on the spectrum of sentimental/spiritual science fiction that is a sweet spot for me, even though i admit that the movies are often flawed (i&#39;m thankful sometimes to love a work of art more rather than less because of its flaws). i&#39;m thankful that in <em>midnight special</em>, it only took me like a half hour to get past the feeling that one of the leads looked like an alternate universe joaquim phoenix and one of the leads looked like an alternate universe channing tatum and get into the movie properly; i&#39;m thankful for adam driver and kirsten dunst, who both looked like themselves (as they always do). i&#39;m thankful for hidden manifestations of celestial architecture. i&#39;m thankful for matthew mcconaughey&#39;s performance in <em>interstellar</em>, which, like so much of his work, is both ridiculous and beautiful at the same time. </p>
<p>i&#39;m thankful that i thought of him reading david edelstein&#39;s <a href="http://www.vulture.com/2016/06/why-have-johnny-depp-films-been-so-bad-lately.html">review cum thinkpiece about what&#39;s eating johnny depp</a>, which has some sick (and imo totally warranted) tim burton burns and has a very interesting section about how after <em>last tango in paris</em>, marlon brando said his performance “<em>required a lot of emotional arm wrestling with myself, and when it was finished, I decided that I wasn’t ever again going to destroy myself emotionally to make a movie. I felt I had violated my innermost self and didn’t want to suffer like that anymore.&quot;</em> i&#39;m thankful that i sometimes think about the validity of decisions like this in a culture that romanticizes the art object at the expense of the health of the artist who produces it (and which often goes beyond that to fetishize the suffering of the artist as a sign of &quot;devotion&quot; or &quot;commitment&quot;). </p>
<p>i&#39;m thankful, as a thought experiment, to posit that you are a writer working on a book and you decide to really torture yourself, not sleeping enough and eating garbage and neglecting important relationships and your own mental health, for a month or three months or six months or whatever, out of a noble and good desire to try to make your book (or whatever) &quot;the best book you could write&quot; and i&#39;m thankful, even, to posit that in this thought experiment, at the end of the line, all of this crunch time actually <em>does</em> make your measurable book better than it would have been if you had maintained a more measured work/life balance (which is not at all a guarantee), i&#39;m thankful, given all this, to ask: <em>is that worth it</em>? </p>
<p>i&#39;m thankful to acknowledge that there can be differences of opinion on this issue, but also thankful to challenge the conventional wisdom that always says <em>yes, it&#39;s worth it</em> and <em><a href="http://therumpus.net/2010/08/dear-sugar-the-rumpus-advice-column-48-write-like-a-motherfucker/">write like a motherfucker</a>,</em> even though i know there are artists whose work i love and admire (probably many and/or most of them!) who would argue that it is worth it and you should work that way, and even though i sometimes do more work on these notes, for example, than i feel like i &quot;should&quot; or is &quot;good for me&quot; (because i &quot;want to&quot;). i&#39;m thankful to tell you that i just wonder about the (completely unverifiable) cost-benefit analysis of the whole thing: like, is it worth making your life 25% worse for three months if it results in your eventual book being 7% better than it would have been otherwise, and thankful, if you believe it <em>is</em> worth it, which is, again, a reasonable and good thing to believe, to then complicate that calculus even further by pointing out that equation isn&#39;t even considering the reader&#39;s experience of the text: is all that work worth it if the book is 7% better for you but if most readers might have read the 7% worse work and loved it just as much as the better version (or more! stranger things have happened)? i&#39;m thankful, if this weren&#39;t complicated enough, to also complicate the notion of writing &quot;the best book you could write,&quot; which is something that&#39;s constructed from your perceptions and standards and tastes at a certain point in time, which will change (maybe dramatically! as is often the case for authors looking back on their early work) as time goes on, and also of course to remind you that there is no direct correlation between quality and $value$, such that your 7% better book has absolutely no guarantee of earning you 7% more money (and might even earn you 7% less!). i&#39;m thankful to ask again: &quot;<em>is that worth it</em>?&quot;</p>
<p>i&#39;m thankful to admit that i don&#39;t know the answer to this, and that the answer i might give is not necessarily the right one, but thankful for the opportunity to question why an intellectual culture that increasingly challenges the neoliberal fetishization of the &quot;value&quot; of work and the cost of entrepreneurship can sometimes be blind to the toll of the invisible labor of the artist. i&#39;m thankful for the way that considering these issues has changed the way i&#39;ve thought about my literary production. i&#39;m thankful that when i was younger, writing was always instrumental, was worthwhile because i believed it would &quot;get&quot; me something or somewhere. i&#39;m thankful that i sometimes experienced pleasure during the act of writing then, the way that finding the right word could spark an association or an image or the deletion of a sentence could make a paragraph click into place, but thankful that the pleasure i mostly got was from having finished something and having somebody read it and &quot;what might happen&quot; when they read it, whether that was a good grade or a validating comment or interest in me romantically or a job or a book deal, which were the things that drove me to work harder and harder, even at a cost to my mind and body that, from the remove of hindsight, doesn&#39;t feel &quot;worth it.&quot; </p>
<p>i&#39;m thankful that i&#39;m human and the desire for validation and gratification still affects me every day (because otherwise why not just write a private diary?), but thankful that i&#39;ve found a form of practice that, for me at least, adds value and richness to my life most days (which is not the same as being &quot;easy,&quot; since this isn&#39;t always &quot;easy&quot;) rather than feeling like something that at times i&#39;m suffering through the dark wilderness of in order to get to an eventual reward (that (spoiler alert) might not exist). i&#39;m thankful that it takes all kinds and to clarify that this is just a description, not a prescription, bound to the way i&#39;m thinking and feeling about my life and work right now (i&#39;m thankful for the part in sarah bakewell&#39;s <em><a href="https://www.amazon.com/How-Live-Montaigne-Question-Attempts/dp/1590514831/ref=sr_1_3?ie=UTF8&qid=1466450050&sr=8-3&keywords=sarah+bakewell">how to live</a></em>, the book i&#39;m reading and loving now, about how every sentence montaigne writes could have &quot;but i don&#39;t know&quot; appended to it). i&#39;m thankful for writers with the discipline to push themselves hard enough to do amazing things, but i&#39;m also thankful to care about those writers as humans and not assembly lines trying to reach every more impossible requirements for optimization.</p>
<p>i&#39;m thankful, in further super exciting and fun news, as my stomach burbles slightly from the froth i have worked myself up into while speed-typing this, to provide an unsatisfying conclusion (for now? i hope?) to my gastroenterological saga, which readers from earlier this year got all the gory details about. i&#39;m thankful that i was finally able to get in to talk to my doctor about the results of the ph monitor i had implanted (twice) in the spring to measure the acid reflux in my esophagus. i&#39;m thankful that he gave me a bemused smile and said that when he first looked at the results from the monitor, it confirmed that i definitely had reflux, but that he was perplexed, because then, reviewing my very scrupulous notes of my experience of my symptoms from when the monitor recording, he found that my experience of my symptoms did not seem to correlate with the measurement of my reflux and that in fact these two seemed to have a largely inverse relationship, such that during the times when i was experiencing &quot;acid reflux symptoms,&quot; my ph was at a normal level whereas the times i wasn&#39;t experiencing symptoms were the times the reflux was actually affecting me. </p>
<p>i&#39;m thankful for the way he threw his hands up in the air as if to say, &quot;<em>yes, this doesn&#39;t make sense</em>!&quot; i&#39;m thankful that he was happy to hear that quitting drinking had reduced the frequency and severity of my symptoms, if not completely getting rid of them, and that he was hesitant to suggest the surgery we had previously discussed (in which the top of my stomach is pulled up and twisted tightly around the bottom of my esophagus), both because my symptoms don&#39;t warrant it and because, given the strangeness of the pattern of symptoms he&#39;d observed, he couldn&#39;t promise it would actually improve things. i&#39;m thankful that he was hopeful that things could continue to improve slowly and said that if my symptoms worsen again and medication doesn&#39;t help enough, the test results had provided the justification for surgery (both medical and in terms of my insurance) and i could come back and see him if necessary. i&#39;m thankful for that, even if it doesn&#39;t make for a particularly satisfying resolution to this story. i&#39;m thankful for an email from a friend earlier this year describing how cutting back on alcohol had improved similar stomach issues for her. i&#39;m thankful that it was a combination of her email and <a href="http://www.tipsybaker.com/2016/01/i-may-never-taste-white-negroni-now.html">a moving post from my favorite blogger</a> that helped drive me to commit more fully to something i had only tried half-heartedly in the past. i&#39;m thankful for how good writing (private, public, literary, or otherwise) can (empower us to) make our lives better.</p>

      </div>
    </article>

    <nav class="navigation">
      <a href="/letters/" class="btn btn-secondary">home</a>
      <div class="nav-links">
        <a href="/letters/letters/thank-you-notes-621.html" class="btn btn-secondary">← thank you notes 6/21</a>
        <a href="/letters/letters/thank-you-notes-619.html" class="btn btn-secondary">thank you notes 6/19 →</a>
      </div>
    </nav>
  
  </div>

  <script>
    // PWA installation prompt
    let deferredPrompt;

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      
      const banner = document.querySelector('.pwa-banner');
      if (banner) {
        banner.style.display = 'flex';
      }
    });

    async function installPWA() {
      if (!deferredPrompt) {
        // If not installable, redirect to PWA
        window.location.href = '/letters/app/';
        return;
      }

      deferredPrompt.prompt();
      const { outcome } = await deferredPrompt.userChoice;
      
      if (outcome === 'accepted') {
        console.log('PWA installed');
      }
      
      deferredPrompt = null;
      const banner = document.querySelector('.pwa-banner');
      if (banner) {
        banner.style.display = 'none';
      }
    }

    function openPWA() {
      window.location.href = '/letters/app/';
    }

    // Progressive Enhancement: Check if user has PWA installed
    // If they do, redirect them to the app version for a richer experience
    if (window.matchMedia('(display-mode: standalone)').matches) {
      // User is in standalone mode (PWA is installed and running)
      // Keep them on static page - they're already in PWA mode
      console.log('Running in PWA mode');
    } else {
      // Check if user has previously used the PWA (has cached data)
      if ('caches' in window) {
        caches.keys().then(cacheNames => {
          const hasPWACache = cacheNames.some(name => 
            name.includes('static-') || name.includes('data-')
          );
          
          // Only show PWA banner if they have cached content
          if (hasPWACache) {
            const banner = document.querySelector('.pwa-banner');
            if (banner && banner.style.display === 'none') {
              banner.style.display = 'flex';
            }
          }
        });
      }
    }

    // Register service worker for all pages
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker
          .register('/letters/sw.js', { scope: '/letters/' })
          .then((registration) => {
            console.log('SW registered:', registration);
          })
          .catch((error) => {
            console.log('SW registration failed:', error);
          });
      });
    }
  </script>
</body>
</html>