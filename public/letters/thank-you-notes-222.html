<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="thank you notes 2/22">
  <title>thank you notes 2/22 - Thank You Notes</title>
  <link rel="manifest" href="/letters/manifest.json">
  <meta name="theme-color" content="#007bff">
  <link rel="apple-touch-icon" href="/letters/icon-192.png">
  <style>
    /**
 * Shared Styles for Thank You Notes
 * Used by both the static site and PWA version
 */

/* Base Reset and Layout */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  background: #f5f5f5;
  color: #333;
  line-height: 1.6;
}

.container {
  max-width: 900px;
  margin: 0 auto;
  padding: 2rem 1rem;
}

/* Loading and Error States */
.loading,
.error {
  text-align: center;
  padding: 3rem;
  font-size: 1.2rem;
}

.error {
  color: #dc3545;
}

/* Header */
.header {
  margin-bottom: 1.5rem;
  text-align: center;
}

.header h1 {
  font-size: 2.5rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  color: #1a1a1a;
}

.subtitle {
  font-size: 1rem;
  color: #666;
}

/* Controls */
.controls {
  margin-bottom: 2rem;
}

.search-container {
  position: relative;
  margin-bottom: 1rem;
}

.search-input {
  width: 100%;
  padding: 0.75rem 2.5rem 0.75rem 1rem;
  font-size: 1rem;
  border: 2px solid #dee2e6;
  border-radius: 8px;
  outline: none;
  transition: border-color 0.2s;
  background: white;
}

.search-input:focus {
  border-color: #007bff;
}

.clear-search {
  position: absolute;
  right: 0.75rem;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  font-size: 1.25rem;
  color: #6c757d;
  cursor: pointer;
  padding: 0.25rem 0.5rem;
  line-height: 1;
  transition: color 0.2s;
}

.clear-search:hover {
  color: #333;
}

.control-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 1rem;
  flex-wrap: wrap;
}

.sort-container {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.sort-container label {
  font-size: 0.875rem;
  font-weight: 500;
  color: #666;
}

.sort-select {
  padding: 0.5rem 0.75rem;
  font-size: 0.875rem;
  border: 2px solid #dee2e6;
  border-radius: 6px;
  background: white;
  cursor: pointer;
  outline: none;
  transition: border-color 0.2s;
}

.sort-select:focus {
  border-color: #007bff;
}

.result-count {
  font-size: 0.875rem;
  font-weight: 600;
  color: #495057;
  padding: 0.5rem 0.75rem;
  background: #e9ecef;
  border-radius: 6px;
  white-space: nowrap;
}

.btn-random {
  background: #28a745;
  color: white;
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 6px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
  white-space: nowrap;
}

.btn-random:hover {
  background: #218838;
  transform: translateY(-1px);
}

.btn-random:active {
  transform: translateY(0);
}

.searching,
.no-results {
  text-align: center;
  padding: 3rem 1rem;
  font-size: 1.1rem;
  color: #666;
}

/* Email/Letter List */
.list,
.letter-list {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

.email-card,
.letter-card {
  background: white;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  cursor: pointer;
  transition: transform 0.2s, box-shadow 0.2s;
  text-decoration: none;
  color: inherit;
  display: block;
}

.email-card:hover,
.letter-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.email-card-image {
  width: 100%;
  height: 200px;
  overflow: hidden;
  background: #e9ecef;
}

.email-card-image img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.email-card-content,
.letter-card {
  padding: 1.5rem;
}

.email-card h2,
.letter-card h2 {
  font-size: 1.5rem;
  margin-bottom: 0.5rem;
  color: #1a1a1a;
  font-weight: 600;
}

.email-description,
.letter-card p {
  color: #666;
  margin-bottom: 0.75rem;
  line-height: 1.5;
}

.email-search-snippet {
  color: #555;
  margin-bottom: 0.75rem;
  line-height: 1.5;
  font-style: italic;
}

.search-highlight {
  background: #fff3cd;
  color: #856404;
  font-weight: 700;
  padding: 0.1rem 0.2rem;
  border-radius: 3px;
  font-style: normal;
}

.email-date,
.letter-card time {
  display: block;
  font-size: 0.875rem;
  color: #888;
}

/* Email/Letter Reader */
.email-reader,
.letter-content {
  background: white;
  border-radius: 8px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  overflow: hidden;
  margin-bottom: 2rem;
}

.email-reader {
  touch-action: pan-y pinch-zoom;
}

.reader-nav,
.navigation {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem 1.5rem;
  background: #f8f9fa;
  border-bottom: 1px solid #dee2e6;
  gap: 1rem;
  flex-wrap: wrap;
}

.reader-nav-bottom {
  border-top: 1px solid #dee2e6;
  border-bottom: none;
}

.nav-buttons,
.nav-links {
  display: flex;
  gap: 0.5rem;
  flex-wrap: wrap;
}

/* Buttons */
.btn {
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
  text-decoration: none;
  display: inline-block;
}

.btn:hover {
  transform: translateY(-1px);
}

.btn:active {
  transform: translateY(0);
}

.btn-secondary {
  background: #6c757d;
  color: white;
}

.btn-secondary:hover {
  background: #5a6268;
}

.btn-nav {
  background: #007bff;
  color: white;
}

.btn-nav:hover {
  background: #0056b3;
}

.btn-back-arrow {
  background: none;
  border: none;
  color: #333;
  cursor: pointer;
  padding: 0.25rem 0.5rem;
  transition: color 0.2s, transform 0.1s;
  line-height: 1;
}

.btn-back-arrow:hover {
  color: #007bff;
  transform: translateX(-2px);
}

.btn-back-arrow:active {
  transform: translateX(0);
}

/* Email/Letter Content */
.email-content,
.letter-content {
  padding: 2rem 1.5rem;
}

.email-header,
.letter-header {
  margin-bottom: 2rem;
  padding-bottom: 1.5rem;
  border-bottom: 2px solid #e9ecef;
}

.email-header h1,
.letter-header h1 {
  font-size: 2rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  color: #1a1a1a;
  line-height: 1.3;
}

.email-header .email-date,
.letter-header time {
  font-size: 1rem;
  color: #666;
}

/* Email/Letter Body Styles */
.email-body,
.letter-body {
  font-size: 1.0625rem;
  line-height: 1.7;
  color: #333;
}

.email-body h1,
.email-body h2,
.email-body h3,
.email-body h4,
.email-body h5,
.email-body h6,
.letter-body h1,
.letter-body h2,
.letter-body h3,
.letter-body h4,
.letter-body h5,
.letter-body h6 {
  margin-top: 1.5rem;
  margin-bottom: 0.75rem;
  font-weight: 600;
  color: #1a1a1a;
  line-height: 1.3;
}

.email-body h1,
.letter-body h1 {
  font-size: 1.875rem;
}

.email-body h2,
.letter-body h2 {
  font-size: 1.5rem;
}

.email-body h3,
.letter-body h3 {
  font-size: 1.25rem;
}

.email-body p,
.letter-body p {
  margin-bottom: 1rem;
}

.email-body a,
.letter-body a {
  color: #007bff;
  text-decoration: none;
}

.email-body a:hover,
.letter-body a:hover {
  text-decoration: underline;
}

.email-body img,
.letter-body img {
  max-width: 100%;
  height: auto;
  border-radius: 4px;
  margin: 1.5rem 0;
}

.email-body ul,
.email-body ol,
.letter-body ul,
.letter-body ol {
  margin-bottom: 1rem;
  padding-left: 2rem;
}

.email-body li,
.letter-body li {
  margin-bottom: 0.5rem;
}

.email-body blockquote,
.letter-body blockquote {
  margin: 1.5rem 0;
  padding-left: 1rem;
  border-left: 4px solid #e9ecef;
  color: #666;
  font-style: italic;
}

.email-body code,
.letter-body code {
  background: #f8f9fa;
  padding: 0.2rem 0.4rem;
  border-radius: 3px;
  font-family: 'Courier New', monospace;
  font-size: 0.9em;
}

.email-body pre,
.letter-body pre {
  background: #f8f9fa;
  padding: 1rem;
  border-radius: 4px;
  overflow-x: auto;
  margin: 1.5rem 0;
}

.email-body pre code,
.letter-body pre code {
  background: none;
  padding: 0;
}

.email-body hr,
.letter-body hr {
  border: none;
  border-top: 2px solid #e9ecef;
  margin: 2rem 0;
}

/* PWA Banner */
.pwa-banner {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 1rem;
  border-radius: 8px;
  margin: 1rem 0 2rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 1rem;
  flex-wrap: wrap;
}

.pwa-banner-text {
  flex: 1;
  min-width: 200px;
}

.pwa-banner-text h3 {
  margin-bottom: 0.25rem;
  font-size: 1.1rem;
}

.pwa-banner-text p {
  font-size: 0.9rem;
  opacity: 0.9;
}

.btn-primary {
  background: #007bff;
  color: white;
  padding: 0.75rem 1.25rem;
  border: none;
  border-radius: 6px;
  font-size: 0.9375rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
}

.btn-primary:hover {
  background: #0056b3;
  transform: translateY(-1px);
}

.btn-primary:active {
  transform: translateY(0);
}

.btn-primary:disabled {
  background: #6c757d;
  cursor: not-allowed;
  transform: none;
}

.btn-danger {
  background: #dc3545;
  color: white;
  padding: 0.75rem 1.25rem;
  border: none;
  border-radius: 6px;
  font-size: 0.9375rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
}

.btn-danger:hover {
  background: #c82333;
  transform: translateY(-1px);
}

.btn-danger:active {
  transform: translateY(0);
}

/* Offline & PWA UI */
.offline-banner {
  background: #ff9800;
  color: white;
  padding: 0.75rem 1rem;
  text-align: center;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-weight: 500;
}

.download-progress {
  background: white;
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.download-progress-bar {
  height: 8px;
  background: #e9ecef;
  border-radius: 4px;
  overflow: hidden;
  margin-bottom: 0.5rem;
}

.download-progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #007bff, #0056b3);
  transition: width 0.3s ease;
}

.download-progress p {
  font-size: 0.875rem;
  color: #666;
  text-align: center;
  margin: 0;
}

.btn-offline {
  background: #6c757d;
  color: white;
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 6px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
  white-space: nowrap;
}

.btn-offline:hover {
  background: #5a6268;
  transform: translateY(-1px);
}

.btn-offline:active {
  transform: translateY(0);
}

.offline-panel {
  background: white;
  padding: 1.5rem;
  border-radius: 8px;
  margin-bottom: 1.5rem;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.offline-panel h3 {
  margin-bottom: 1rem;
  color: #1a1a1a;
  font-size: 1.25rem;
}

.offline-stats {
  background: #f8f9fa;
  padding: 1rem;
  border-radius: 6px;
  margin-bottom: 1rem;
}

.offline-stats p {
  margin: 0.5rem 0;
  color: #495057;
  font-size: 0.9375rem;
}

.offline-actions {
  display: flex;
  gap: 0.75rem;
  margin-bottom: 1rem;
  flex-wrap: wrap;
}

.offline-note {
  font-size: 0.875rem;
  color: #666;
  line-height: 1.5;
  margin: 0;
  font-style: italic;
}

/* Responsive Design */
@media (max-width: 768px) {
  .container {
    padding: 1rem 0.5rem;
  }

  .header h1 {
    font-size: 2rem;
  }

  .control-row {
    flex-direction: column;
    align-items: stretch;
  }

  .sort-container {
    width: 100%;
    justify-content: space-between;
  }

  .sort-select {
    flex: 1;
  }

  .result-count {
    text-align: center;
  }

  .btn-random {
    width: 100%;
  }

  .email-card-content {
    padding: 1rem;
  }

  .email-card h2 {
    font-size: 1.25rem;
  }

  .email-content,
  .letter-content {
    padding: 1.5rem 1rem;
  }

  .email-header h1,
  .letter-header h1 {
    font-size: 1.5rem;
  }

  .reader-nav,
  .navigation {
    flex-direction: column;
    align-items: stretch;
  }

  .nav-buttons,
  .nav-links {
    flex-direction: column;
  }

  .btn {
    width: 100%;
    text-align: center;
  }

  .btn-nav {
    font-size: 0.8125rem;
    white-space: normal;
    word-wrap: break-word;
  }

  body {
    padding: 10px;
  }

  .pwa-banner {
    flex-direction: column;
    text-align: center;
  }
}

@media (max-width: 480px) {
  .email-card-image {
    height: 150px;
  }

  .email-body,
  .letter-body {
    font-size: 1rem;
  }
}

    
    /* Static site specific adjustments */
    body {
      padding: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    
    <div class="pwa-banner" style="display: none;">
      <div class="pwa-banner-text">
        <h3>üì± Read Offline</h3>
        <p>Install the app to read all letters offline</p>
      </div>
      <div>
        <button class="btn btn-primary" onclick="installPWA()">Install App</button>
      </div>
    </div>

    <article class="letter-content">
      <header class="letter-header">
        <h1>thank you notes 2/22</h1>
        <time datetime="2016-02-22T00:00:00Z">February 21, 2016</time>
      </header>

      <div class="letter-body">
        <p>i&#39;m thankful for chapter 21 of <em><a href="http://www.amazon.com/This-Should-Written-Present-Tense-ebook/dp/B018DWLBPO/ref=la_B00IWSU3HM_1_1?s=books&ie=UTF8&qid=1456155816&sr=1-1">this should be written in the present tense</a></em> by helle helle, the book i&#39;m currently reading, which is, in full: &quot;<em>One day I went for a bike ride while Per was having a nap. I cycled aimlessly in the direction of the nursery, it was late afternoon. The forsythias were in bloom in a few small front gardens. I was soon too hot in my jumper. I stopped to take it off, then carried on in my T-shirt. A smell of seaweed and salt water hung over the fields, they must have been out¬†fertilizing. There was a song in my head for a confirmation party. I tried to¬†think of a rhyme for pony, but all I could come up with was stony, phony, bony. The road passed through a little wood. I felt a chill on my arms as I passed through the shade, but then I came out the other side and into the warm air again. I stopped by a solitary tree at the side of the road and folded my jumper tighter on the pannier rack. The sun was very bright. I closed my eyes and turned my face upwards, and stood there for a while. I could hear myself breathing, everything turned red behind my eyelids. The bird we called the bicycle pump chirped somewhere close by, further away I heard the noise of a tractor. I thought: Here I am with only myself. Apart from the sun and the tractor and the bicycle pump. There was a warm breeze against my skin and my trainers fitted my feet just right, I&#39;d never noticed before. A car approached and I let it go by, my eyes still closed. I wiggled my toes. I stretched my fingers out from the handlebars. By the time I opened my eyes all my thoughts had left me. I got on the bike again and carried slowly on, empty and content. At the nursery I turned down the gravel track, I walked the last bit and leaned the bike against some stacked-up sacks of peat. Lars was in the evergreens behind the goats, I could see his anorak. I looked at the hardy perennials, the grasses and the cactuses, and read all the names. Then I went down to join him, he turned round with a smile, pulled off his glove and gave me his warm, dry hand. He showed me a mahonia shrub, it was a different thing altogether from the tree variety. It was in bloom, with fragrant yellow flowers. We talked for a while. He walked me back to my bike and all the way up the gravel track, where we talked some more</em>.&quot;</p>
<p>i&#39;m thankful for the soothing lull of her narrative style, for the feeling of <a href="http://genius.com/Grimes-be-a-body-lyrics">being a body</a>¬†(i&#39;m thankful to have learned a little bit this morning about the concept of <a href="https://en.wikipedia.org/wiki/Wabi-sabi">wabi-sabi</a>¬†and for how that interacts with what i was reading about last night in <a href="http://www.amazon.com/25-Lessons-Mindfulness-Healthy-Living/dp/1433813238">a book</a> on mindfulness about the buddhist distinction between pain (inevitable) and suffering (not)).¬†i&#39;m thankful for how the feel of helle helle&#39;s book and <a href="http://electricliterature.com/this-has-been-written-in-front-of-us-on-helle-helles-first-novel-to-be-released-in-the-us/">this review</a>¬†that made me decide to buy it (i&#39;m thankful for book reviews) reminded me of ben lerner&#39;s description of the druggy-ness of knausgaard&#39;s attention to detail¬†<a href="http://www.lrb.co.uk/v36/n10/ben-lerner/each-cornflake">in the LRB</a> and how &quot;<em>most critics attempt to demonstrate a novelist‚Äôs perceptiveness by providing examples of his eye for the significant detail. But part of what makes Knausgaard‚Äôs writing unusual is that he seems barely to adjudicate significance; he‚Äôs like a child who has taken Henry James‚Äôs injunction to novelists ‚Äì ‚Äòbe one of the people on whom nothing is lost‚Äô ‚Äì literally; he appears to just write down everything he can recall (and he appears to recall everything).&quot;</em>¬†i&#39;m thankful for the passage from baudelaire lerner quotes to highlight &quot;the unusually equal weighting of experience that evokes both childhood and drugs&quot;: &quot;<em>[Genius] is no more than childhood recaptured at will, childhood equipped now with man‚Äôs physical means to express itself, and with the analytical mind that enables it to bring order into the sum of experience, involuntarily amassed. To this deep and joyful curiosity must be attributed that stare, animal-like in its ecstasy, which all children have when confronted with something new, whatever it may be, face or landscape, light, gilding, colours, watered silk</em>.&quot; i&#39;m thankful to remember one time when i was on mushrooms in college lying on the ground in our backyard and looking up at the branches of the trees against the blue sky, trying to trace the complexity of their network.</p>
<p>i&#39;m thankful, because i love to follow the <a href="https://en.wikipedia.org/wiki/Rule_of_three_(writing)">rule of three</a>, to continue exploring the literary ordinary by recommending <a href="http://www.nytimes.com/2016/02/21/magazine/the-quietly-subversive-fictions-of-dana-spiotta.html?_r=0">the excellent profile</a> of dana spiotta in yesterday&#39;s <em>times magazine</em>, which makes a virtue of noticing how she notices things. i&#39;m thankful for the description of her plugging old phones into wall jacks to hear their tones. i&#39;m thankful for her digression about the meaning of attending to something (<em>‚Äò‚Äò‚Äâ‚ÄòAttend‚Äô comes from ‚Äòattendere,‚Äô which means ‚Äòto stretch,‚Äô‚Äâ‚Äô‚Äô she emailed one morning. ‚Äò‚ÄòThat is so interesting, as if attending means you have to stretch your mind toward another.‚Äô‚Äô&quot;</em>). i&#39;m thankful for the funny scene where she and the writer try to use waze to find a place. i&#39;m thankful for how excited the description of her mood board (&quot;¬†<em>lists of relevant words (passion, transformation, intimacy) and ‚Äò‚Äòseeing‚Äô‚Äô devices (zoetrope, stereoscope, camera obscura), and photographs of Orson Welles, Jean-Luc Godard and the Maysles brothers</em>&quot;) makes me feel about her new novel. i&#39;m thankful for her assertion about the importance of noticing, that &quot;<em>what you notice is who you are, maybe</em>&quot;¬†</p>
<p>i&#39;m thankful to remember reading¬†<em>stone arabia</em> at night¬†in our tiny¬†<a href="https://www.morganshotelgroup.com/hudson/hudson-new-york">hotel room</a> in new york and how happy i felt, shell-shocked from the sensory bombardment of walking in the city, to be drinking vodka out of a small clear plastic cup while snuggled next to d under the blankets in a warm quiet bed reading a book. i&#39;m thankful to remember the islands of peace we found in that trip, which was at times so intense and stressful for both of us (i&#39;m thankful to remember our first night when we were trying to take the subway back to the hotel from chinatown and were unsure about whether we were going the right way and how the train suddenly came out of the tunnel and we were on a bridge high above the river and realized that yes, we were going the wrong way). i&#39;m thankful to remember how a fancier version of benihana near NYU gave us an opportunity to recharge our batteries when we were very tired, for the solace of a quiet and comfortable booth. i&#39;m thankful to remember how grateful i was to find that the strand had a water fountain.¬†</p>
<p>i&#39;m thankful for how yesterday morning i saw a pair of deer i saw darting across the park. i&#39;m thankful for the grace with which one leapt over a traffic bollard. i&#39;m thankful that unlike any other place i&#39;ve lived, deer are common here and you see them all the time in the course of your day. i&#39;m thankful that when i left the paved path in the park to avoid a fleet of strollers and immediately realized that i was running through mud, the mud was broad in surface area but not deep, so i didn&#39;t sink in and it didn&#39;t really mess up my shoes. i&#39;m thankful for the guy on the moped at the stop sign who nudged himself back a few feet to clear the intersection for me to run through. i&#39;m thankful that even though, when i started to go through the intersection, the white SUV on the other side of the cross street came through and cut me off, forcing me to stop abruptly. i&#39;m thankful that this sort of behavior usually pisses me off, but i&#39;m thankful that the driver had her window open because of the warmth and i&#39;m thankful how she clearly mouthed &quot;sorry&quot; and raised her hand and smiled and thankful that i was so happy to be out running in the sun that i smiled back and waved. i&#39;m thankful for how i kept running south instead of taking my usual path because i was afraid it would be too muddy. i&#39;m thankful that i kept going further and further because i wanted to see how long before the end of the sidewalk, and thankful that when i got there, i found a golf course i never knew existed.</p>

      </div>
    </article>

    <nav class="navigation">
      <a href="/letters/" class="btn btn-secondary">home</a>
      <div class="nav-links">
        <a href="/letters/letters/thank-you-notes-anonymous.html" class="btn btn-secondary">‚Üê thank you notes (anonymous)</a>
        <a href="/letters/letters/thank-you-notes-221.html" class="btn btn-secondary">thank you notes 2/21 ‚Üí</a>
      </div>
    </nav>
  
  </div>

  <script>
    // PWA installation prompt
    let deferredPrompt;

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      
      const banner = document.querySelector('.pwa-banner');
      if (banner) {
        banner.style.display = 'flex';
      }
    });

    async function installPWA() {
      if (!deferredPrompt) {
        // If not installable, redirect to PWA
        window.location.href = '/letters/app/';
        return;
      }

      deferredPrompt.prompt();
      const { outcome } = await deferredPrompt.userChoice;
      
      if (outcome === 'accepted') {
        console.log('PWA installed');
      }
      
      deferredPrompt = null;
      const banner = document.querySelector('.pwa-banner');
      if (banner) {
        banner.style.display = 'none';
      }
    }

    function openPWA() {
      window.location.href = '/letters/app/';
    }

    // Progressive Enhancement: Check if user has PWA installed
    // If they do, redirect them to the app version for a richer experience
    if (window.matchMedia('(display-mode: standalone)').matches) {
      // User is in standalone mode (PWA is installed and running)
      // Keep them on static page - they're already in PWA mode
      console.log('Running in PWA mode');
    } else {
      // Check if user has previously used the PWA (has cached data)
      if ('caches' in window) {
        caches.keys().then(cacheNames => {
          const hasPWACache = cacheNames.some(name => 
            name.includes('static-') || name.includes('data-')
          );
          
          // Only show PWA banner if they have cached content
          if (hasPWACache) {
            const banner = document.querySelector('.pwa-banner');
            if (banner && banner.style.display === 'none') {
              banner.style.display = 'flex';
            }
          }
        });
      }
    }

    // Register service worker for all pages
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker
          .register('/letters/sw.js', { scope: '/letters/' })
          .then((registration) => {
            console.log('SW registered:', registration);
          })
          .catch((error) => {
            console.log('SW registration failed:', error);
          });
      });
    }
  </script>
</body>
</html>