<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="8/29/17">
  <title>8/29/17 - Thank You Notes</title>
  <link rel="manifest" href="/letters/manifest.json">
  <meta name="theme-color" content="#007bff">
  <link rel="apple-touch-icon" href="/letters/icon-192.png">
  <style>
    /**
 * Shared Styles for Thank You Notes
 * Used by both the static site and PWA version
 */

/* Base Reset and Layout */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  background: #f5f5f5;
  color: #333;
  line-height: 1.6;
}

.container {
  max-width: 900px;
  margin: 0 auto;
  padding: 2rem 1rem;
}

/* Loading and Error States */
.loading,
.error {
  text-align: center;
  padding: 3rem;
  font-size: 1.2rem;
}

.error {
  color: #dc3545;
}

/* Header */
.header {
  margin-bottom: 1.5rem;
  text-align: center;
}

.header h1 {
  font-size: 2.5rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  color: #1a1a1a;
}

.subtitle {
  font-size: 1rem;
  color: #666;
}

/* Controls */
.controls {
  margin-bottom: 2rem;
}

.search-container {
  position: relative;
  margin-bottom: 1rem;
}

.search-input {
  width: 100%;
  padding: 0.75rem 2.5rem 0.75rem 1rem;
  font-size: 1rem;
  border: 2px solid #dee2e6;
  border-radius: 8px;
  outline: none;
  transition: border-color 0.2s;
  background: white;
}

.search-input:focus {
  border-color: #007bff;
}

.clear-search {
  position: absolute;
  right: 0.75rem;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  font-size: 1.25rem;
  color: #6c757d;
  cursor: pointer;
  padding: 0.25rem 0.5rem;
  line-height: 1;
  transition: color 0.2s;
}

.clear-search:hover {
  color: #333;
}

.control-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 1rem;
  flex-wrap: wrap;
}

.sort-container {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.sort-container label {
  font-size: 0.875rem;
  font-weight: 500;
  color: #666;
}

.sort-select {
  padding: 0.5rem 0.75rem;
  font-size: 0.875rem;
  border: 2px solid #dee2e6;
  border-radius: 6px;
  background: white;
  cursor: pointer;
  outline: none;
  transition: border-color 0.2s;
}

.sort-select:focus {
  border-color: #007bff;
}

.result-count {
  font-size: 0.875rem;
  font-weight: 600;
  color: #495057;
  padding: 0.5rem 0.75rem;
  background: #e9ecef;
  border-radius: 6px;
  white-space: nowrap;
}

.btn-random {
  background: #28a745;
  color: white;
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 6px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
  white-space: nowrap;
}

.btn-random:hover {
  background: #218838;
  transform: translateY(-1px);
}

.btn-random:active {
  transform: translateY(0);
}

.searching,
.no-results {
  text-align: center;
  padding: 3rem 1rem;
  font-size: 1.1rem;
  color: #666;
}

/* Email/Letter List */
.list,
.letter-list {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

.email-card,
.letter-card {
  background: white;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  cursor: pointer;
  transition: transform 0.2s, box-shadow 0.2s;
  text-decoration: none;
  color: inherit;
  display: block;
}

.email-card:hover,
.letter-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.email-card-image {
  width: 100%;
  height: 200px;
  overflow: hidden;
  background: #e9ecef;
}

.email-card-image img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.email-card-content,
.letter-card {
  padding: 1.5rem;
}

.email-card h2,
.letter-card h2 {
  font-size: 1.5rem;
  margin-bottom: 0.5rem;
  color: #1a1a1a;
  font-weight: 600;
}

.email-description,
.letter-card p {
  color: #666;
  margin-bottom: 0.75rem;
  line-height: 1.5;
}

.email-search-snippet {
  color: #555;
  margin-bottom: 0.75rem;
  line-height: 1.5;
  font-style: italic;
}

.search-highlight {
  background: #fff3cd;
  color: #856404;
  font-weight: 700;
  padding: 0.1rem 0.2rem;
  border-radius: 3px;
  font-style: normal;
}

.email-date,
.letter-card time {
  display: block;
  font-size: 0.875rem;
  color: #888;
}

/* Email/Letter Reader */
.email-reader,
.letter-content {
  background: white;
  border-radius: 8px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  overflow: hidden;
  margin-bottom: 2rem;
}

.email-reader {
  touch-action: pan-y pinch-zoom;
}

.reader-nav,
.navigation {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem 1.5rem;
  background: #f8f9fa;
  border-bottom: 1px solid #dee2e6;
  gap: 1rem;
  flex-wrap: wrap;
}

.reader-nav-bottom {
  border-top: 1px solid #dee2e6;
  border-bottom: none;
}

.nav-buttons,
.nav-links {
  display: flex;
  gap: 0.5rem;
  flex-wrap: wrap;
}

/* Buttons */
.btn {
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
  text-decoration: none;
  display: inline-block;
}

.btn:hover {
  transform: translateY(-1px);
}

.btn:active {
  transform: translateY(0);
}

.btn-secondary {
  background: #6c757d;
  color: white;
}

.btn-secondary:hover {
  background: #5a6268;
}

.btn-nav {
  background: #007bff;
  color: white;
}

.btn-nav:hover {
  background: #0056b3;
}

.btn-back-arrow {
  background: none;
  border: none;
  color: #333;
  cursor: pointer;
  padding: 0.25rem 0.5rem;
  transition: color 0.2s, transform 0.1s;
  line-height: 1;
}

.btn-back-arrow:hover {
  color: #007bff;
  transform: translateX(-2px);
}

.btn-back-arrow:active {
  transform: translateX(0);
}

/* Email/Letter Content */
.email-content,
.letter-content {
  padding: 2rem 1.5rem;
}

.email-header,
.letter-header {
  margin-bottom: 2rem;
  padding-bottom: 1.5rem;
  border-bottom: 2px solid #e9ecef;
}

.email-header h1,
.letter-header h1 {
  font-size: 2rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  color: #1a1a1a;
  line-height: 1.3;
}

.email-header .email-date,
.letter-header time {
  font-size: 1rem;
  color: #666;
}

/* Email/Letter Body Styles */
.email-body,
.letter-body {
  font-size: 1.0625rem;
  line-height: 1.7;
  color: #333;
}

.email-body h1,
.email-body h2,
.email-body h3,
.email-body h4,
.email-body h5,
.email-body h6,
.letter-body h1,
.letter-body h2,
.letter-body h3,
.letter-body h4,
.letter-body h5,
.letter-body h6 {
  margin-top: 1.5rem;
  margin-bottom: 0.75rem;
  font-weight: 600;
  color: #1a1a1a;
  line-height: 1.3;
}

.email-body h1,
.letter-body h1 {
  font-size: 1.875rem;
}

.email-body h2,
.letter-body h2 {
  font-size: 1.5rem;
}

.email-body h3,
.letter-body h3 {
  font-size: 1.25rem;
}

.email-body p,
.letter-body p {
  margin-bottom: 1rem;
}

.email-body a,
.letter-body a {
  color: #007bff;
  text-decoration: none;
}

.email-body a:hover,
.letter-body a:hover {
  text-decoration: underline;
}

.email-body img,
.letter-body img {
  max-width: 100%;
  height: auto;
  border-radius: 4px;
  margin: 1.5rem 0;
}

.email-body ul,
.email-body ol,
.letter-body ul,
.letter-body ol {
  margin-bottom: 1rem;
  padding-left: 2rem;
}

.email-body li,
.letter-body li {
  margin-bottom: 0.5rem;
}

.email-body blockquote,
.letter-body blockquote {
  margin: 1.5rem 0;
  padding-left: 1rem;
  border-left: 4px solid #e9ecef;
  color: #666;
  font-style: italic;
}

.email-body code,
.letter-body code {
  background: #f8f9fa;
  padding: 0.2rem 0.4rem;
  border-radius: 3px;
  font-family: 'Courier New', monospace;
  font-size: 0.9em;
}

.email-body pre,
.letter-body pre {
  background: #f8f9fa;
  padding: 1rem;
  border-radius: 4px;
  overflow-x: auto;
  margin: 1.5rem 0;
}

.email-body pre code,
.letter-body pre code {
  background: none;
  padding: 0;
}

.email-body hr,
.letter-body hr {
  border: none;
  border-top: 2px solid #e9ecef;
  margin: 2rem 0;
}

/* PWA Banner */
.pwa-banner {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 1rem;
  border-radius: 8px;
  margin: 1rem 0 2rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 1rem;
  flex-wrap: wrap;
}

.pwa-banner-text {
  flex: 1;
  min-width: 200px;
}

.pwa-banner-text h3 {
  margin-bottom: 0.25rem;
  font-size: 1.1rem;
}

.pwa-banner-text p {
  font-size: 0.9rem;
  opacity: 0.9;
}

.btn-primary {
  background: #007bff;
  color: white;
  padding: 0.75rem 1.25rem;
  border: none;
  border-radius: 6px;
  font-size: 0.9375rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
}

.btn-primary:hover {
  background: #0056b3;
  transform: translateY(-1px);
}

.btn-primary:active {
  transform: translateY(0);
}

.btn-primary:disabled {
  background: #6c757d;
  cursor: not-allowed;
  transform: none;
}

.btn-danger {
  background: #dc3545;
  color: white;
  padding: 0.75rem 1.25rem;
  border: none;
  border-radius: 6px;
  font-size: 0.9375rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
}

.btn-danger:hover {
  background: #c82333;
  transform: translateY(-1px);
}

.btn-danger:active {
  transform: translateY(0);
}

/* Offline & PWA UI */
.offline-banner {
  background: #ff9800;
  color: white;
  padding: 0.75rem 1rem;
  text-align: center;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-weight: 500;
}

.download-progress {
  background: white;
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.download-progress-bar {
  height: 8px;
  background: #e9ecef;
  border-radius: 4px;
  overflow: hidden;
  margin-bottom: 0.5rem;
}

.download-progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #007bff, #0056b3);
  transition: width 0.3s ease;
}

.download-progress p {
  font-size: 0.875rem;
  color: #666;
  text-align: center;
  margin: 0;
}

.btn-offline {
  background: #6c757d;
  color: white;
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 6px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
  white-space: nowrap;
}

.btn-offline:hover {
  background: #5a6268;
  transform: translateY(-1px);
}

.btn-offline:active {
  transform: translateY(0);
}

.offline-panel {
  background: white;
  padding: 1.5rem;
  border-radius: 8px;
  margin-bottom: 1.5rem;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.offline-panel h3 {
  margin-bottom: 1rem;
  color: #1a1a1a;
  font-size: 1.25rem;
}

.offline-stats {
  background: #f8f9fa;
  padding: 1rem;
  border-radius: 6px;
  margin-bottom: 1rem;
}

.offline-stats p {
  margin: 0.5rem 0;
  color: #495057;
  font-size: 0.9375rem;
}

.offline-actions {
  display: flex;
  gap: 0.75rem;
  margin-bottom: 1rem;
  flex-wrap: wrap;
}

.offline-note {
  font-size: 0.875rem;
  color: #666;
  line-height: 1.5;
  margin: 0;
  font-style: italic;
}

/* Responsive Design */
@media (max-width: 768px) {
  .container {
    padding: 1rem 0.5rem;
  }

  .header h1 {
    font-size: 2rem;
  }

  .control-row {
    flex-direction: column;
    align-items: stretch;
  }

  .sort-container {
    width: 100%;
    justify-content: space-between;
  }

  .sort-select {
    flex: 1;
  }

  .result-count {
    text-align: center;
  }

  .btn-random {
    width: 100%;
  }

  .email-card-content {
    padding: 1rem;
  }

  .email-card h2 {
    font-size: 1.25rem;
  }

  .email-content,
  .letter-content {
    padding: 1.5rem 1rem;
  }

  .email-header h1,
  .letter-header h1 {
    font-size: 1.5rem;
  }

  .reader-nav,
  .navigation {
    flex-direction: column;
    align-items: stretch;
  }

  .nav-buttons,
  .nav-links {
    flex-direction: column;
  }

  .btn {
    width: 100%;
    text-align: center;
  }

  .btn-nav {
    font-size: 0.8125rem;
    white-space: normal;
    word-wrap: break-word;
  }

  body {
    padding: 10px;
  }

  .pwa-banner {
    flex-direction: column;
    text-align: center;
  }
}

@media (max-width: 480px) {
  .email-card-image {
    height: 150px;
  }

  .email-body,
  .letter-body {
    font-size: 1rem;
  }
}

    
    /* Static site specific adjustments */
    body {
      padding: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    
    <div class="pwa-banner" style="display: none;">
      <div class="pwa-banner-text">
        <h3>📱 Read Offline</h3>
        <p>Install the app to read all letters offline</p>
      </div>
      <div>
        <button class="btn btn-primary" onclick="installPWA()">Install App</button>
      </div>
    </div>

    <article class="letter-content">
      <header class="letter-header">
        <h1>8/29/17</h1>
        <time datetime="2017-08-29T00:00:00Z">August 28, 2017</time>
      </header>

      <div class="letter-body">
        <p>i&#39;m thankful for <a href="http://tinyletter.com/ohevie/letters/everything-happened-vol-133">evie&#39;s tinyletter</a> about moving from an old apartment in the city to a new house in the suburbs and what that feels like. i&#39;m thankful in particular for her attention to the differences between her old dishwasher, &quot;<em>a massive appliance that demanded much precious kitchen real estate</em>&quot; and that &quot;<em>even with pre-rinsing, left reminders of past dinners on all of our plates and our glasses clouded and dull</em>&quot; with her new dishwasher. </p>
<p>i&#39;m thankful for our new dishwasher, which works much better than our old dishwasher at cleaning dishes; i&#39;m thankful to like hand washing dishes more than evie, but i&#39;m also thankful to not always have to do it. i&#39;m thankful that the other night i turned it on right before bed and am thankful for the way that down the hall from our bedroom it sounded like a waterfall. i&#39;m thankful to have discussed our new &quot;dishwasher lifestyle&quot; with d yesterday before dinner and how as a part of that we should buy more bowls and forks and spoons in order to accommodate that lifestyle.</p>
<p>i&#39;m thankful that last night d was talking about someone we know trying (and failing) to cheat on his wife and while developing a thought on it i asked d if we had ever talked about jimmy carter&#39;s &quot;<em>sinned in my heart</em>&quot; controversy and she did the laugh equivalent of rolling her eyes and said that yes we had and had in fact had this exact conversation about whether we had ever talked about sinning in the heart (i&#39;m thankful to have just searched my email and to feel fairly confident that i have not talked to you about this). i&#39;m thankful that she then told me about how when we were at her work barbecue last week she had seen me across the yard talking to a group of people and considered going over but decided not to because she figured she had probably heard all of the anecdotes i was telling before.</p>
<p>i&#39;m thankful that this is one of the top rude but true things d has said about me in our relationship. i&#39;m thankful to remember the class in grad school where d and i met and started dating, which was a fiction workshop taught by a bitter older man (who i&#39;m thankful no longer teaches there). i&#39;m thankful GODDAMNIT PROVING THE POINT to have just realized while writing this paragraph and in the background searching through my email with various phrases that seem like phrases i would use (that i already wrote about this whole phenomenon in <a href="http://tinyletter.com/thankyounotes/letters/thank-you-notes-9-18">september 2016</a>:</p>
<p>&quot;<em>i&#39;m thankful that yesterday, while looking for an old email, i got distracted by looking at other old emails. i&#39;m thankful that in this spell of distraction, i discovered that i had told the anecdote i told last sunday about 9/11 in these notes before, in slightly different form, and that when i told it the second time i had forgotten about telling it the first time. i&#39;m thankful, though i try to prevent this from happening (or at least, if i&#39;m compelled to be repeatedly thankful for something, to express self-consciousness (&quot;i know i&#39;ve been thankful for this before, but&quot;) when i do it), to have accepted the inevitability of this happening, and am thankful to accept that it has probably already happened other times too without me noticing it.</em> </p>
<p><em>i&#39;m thankful for the professor who led my first workshop in graduate school, even though he was not a particularly good professor. i&#39;m thankful for something strange my classmates and i discovered as the semester progressed, which was that he would repeat the same anecdotes from his life to us week after week. i&#39;m thankful that he would not only repeat them in terms of narrative beats and pedagogical takeaways, but would repeat them without any acknowledgement he&#39;d said them before, as if they were new stories, and that, beyond that, would repeat them (we discovered over time) almost word for word the same way every time, like there was a teleprompter inside his eyes re-feeding him speech. i&#39;m thankful that over the course of that class (and another one that i took with him my third year), my classmates and i heard these same stories and memories and opinions of his over and over again, without variation.</em> </p>
<p><em>i&#39;m thankful that this was disturbing and that as a class we told ourselves jokes to cope. i&#39;m thankful, even though i think it&#39;s kind of funny, to know that it was an uncharitable illness as metaphor joke when at the bar after workshop one day i said that he was like the MFA program version of an old boxer, brain damaged from too many concussions, except that the cause here was bad stories instead of uppercuts and jabs. i&#39;m thankful that my brain likes to make up stories to explain the world and that one i occasionally found myself daydreaming was a meta take on his behavior, that he was actually completely aware of what he was doing and it was all a performance that was going to eventually, at the end of the semester, lead to him making some larger point about narrative and repetition (i&#39;m thankful this was perhaps inspired by one of his favorite creativity quotes to repeat and repeat, which was miles davis saying &quot;do it once, it&#39;s a mistake; do it twice, and it&#39;s jazz&quot;).</em> </p>
<p><em>i&#39;m thankful (i guess) that there was never this revelation, though, only him sitting at the end of the seminar table on the last day of the semester angrily reflecting on our youthful insolence by refusing to give us teacher evaluation forms (because, he said, &quot;i have tenure and it doesn&#39;t matter&quot;) and then having us look to the person on either side of us and saying that one of those people would never write again or publish anything after we graduated (which we found ludicrous at the time, but has generally proved true on some level). i&#39;m thankful to remember, instead of that unpleasantness, one of his favorite anecdotes that he would retell anytime anyone did anything even vaguely &quot;experimental&quot; (i&#39;m thankful to raise my hand here), which was how when he was young he had seen john barth give a &quot;reading&quot; where he played the story over two reel to reel tape players that were going in and out of sync. (i&#39;m thankful to imagine consciousness as an input source being fed through a signal chain of effects: distortion, chorus, echo, delay).</em></p>
<p><em>i&#39;m thankful that my brain is not my professor&#39;s brain, but thankful, five years later, to have experienced how my brain has changed over that period of time and to understand that my brain is probably more like his brain than unlike. i&#39;m thankful to have started noticing this in my conversations with my friends from graduate school, who i went from seeing daily to weekly to monthly and then even more infrequently. i&#39;m thankful that when we did see each other, we would try to catch up on each others&#39; lives and to talk about the various media we&#39;d been consuming recently, about the struggles of real work and what/whether we were writing, but that eventually we would fall into big fluffy clouds of reminiscence about the past we&#39;d lived in together. i&#39;m thankful to have started to find myself beginning an anecdote saying, with increasing regularity, the phrase, &quot;i can&#39;t remember if we talked about this before, but...&quot; or sometimes thinking that phrase, knowing it was true, even, but not saying it because it felt embarrassing to say and so just repeating the anecdote to my friends anyway because it felt good to move it from inside my brain out into the world through words.</em> </p>
<p><em>i&#39;m thankful to wonder if, over time, more and more of my brain will become fixed in place like this, the way that you hear some people say that the reason you so often see old people sitting in silence, staring off into space, is that there is so much experience in the past for them that it feels, in a way, more present than the present, more vivid and important. i&#39;m thankful, as someone who is already prone to daydreaming and fantasizing about the past, to imagine being able to take these mini acid trips into my history. i&#39;m thankful to think about one of the awful things about dementia, which my grandmother had before she died, which is how it can take away the past from you, or at least take away the coherence of the past, which, in turn, can render the present, which is always in the process of becoming the past, meaningless, a collection of jagged fragments that you can&#39;t hold together.</em></p>
<p><em>i&#39;m thankful to have thought about this last night while i was doing some yoga and happily re-listening to an episode of a podcast i&#39;ve heard tens of times before. i&#39;m thankful that though there are topical podcasts that i look forward to listening to new episodes of every week, i also have a collection of shows and episodes i&#39;ve listened to many times before but know that i can always listen to again. i&#39;m thankful to find this comforting, to live inside the comfort of this bubble of repetition—to not only know what will be talked about, but, as i listen to the hosts talk, to know that a particular line is coming, a word choice, a phrase, a laugh. i&#39;m thankful, sometimes, when one ends, to scrub back to the beginning and press play again, to start over from the same beginning</em>.&quot;</p>
<p>i&#39;m thankful to have my email archives as an aid to memory (or, more specifically, as an aid to whether i have already remembered something publicly). i&#39;m thankful to write about my day yesterday, since i know that at least in its particularities if not its generalities that is not something i&#39;ve told you about yet. i&#39;m thankful that i had a really good video call with someone who i wrote about being jealous of here before but who is the sweetest person and who i had a great time nerding out with about various things that we are both interested in. i&#39;m thankful for the comment an engineer left on one of my tickets describing my assessment of a situation as &quot;<em>spot on</em>&quot; and linking me to the part of the source code underpinning the situation to show me how what i had noticed had happened. i&#39;m thankful that my doctor&#39;s office got the prescription for my new antidepressant called in in time for me to pick it up today so that i won&#39;t have to miss a dose and am thankful to have requested to bump up the dose soon. i&#39;m thankful to hope that i have a good day today, even if having a good day doesn&#39;t always mean that interesting or memorable things will happen. i&#39;m thankful, if i have a choice, to choose a good day over an &quot;interesting&quot; day.</p>

      </div>
    </article>

    <nav class="navigation">
      <a href="/letters/" class="btn btn-secondary">home</a>
      <div class="nav-links">
        <a href="/letters/letters/83017.html" class="btn btn-secondary">← 8/30/17</a>
        <a href="/letters/letters/828-6299.html" class="btn btn-secondary">8/28 →</a>
      </div>
    </nav>
  
  </div>

  <script>
    // PWA installation prompt
    let deferredPrompt;

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      
      const banner = document.querySelector('.pwa-banner');
      if (banner) {
        banner.style.display = 'flex';
      }
    });

    async function installPWA() {
      if (!deferredPrompt) {
        // If not installable, redirect to PWA
        window.location.href = '/letters/app/';
        return;
      }

      deferredPrompt.prompt();
      const { outcome } = await deferredPrompt.userChoice;
      
      if (outcome === 'accepted') {
        console.log('PWA installed');
      }
      
      deferredPrompt = null;
      const banner = document.querySelector('.pwa-banner');
      if (banner) {
        banner.style.display = 'none';
      }
    }

    function openPWA() {
      window.location.href = '/letters/app/';
    }

    // Progressive Enhancement: Check if user has PWA installed
    // If they do, redirect them to the app version for a richer experience
    if (window.matchMedia('(display-mode: standalone)').matches) {
      // User is in standalone mode (PWA is installed and running)
      // Keep them on static page - they're already in PWA mode
      console.log('Running in PWA mode');
    } else {
      // Check if user has previously used the PWA (has cached data)
      if ('caches' in window) {
        caches.keys().then(cacheNames => {
          const hasPWACache = cacheNames.some(name => 
            name.includes('static-') || name.includes('data-')
          );
          
          // Only show PWA banner if they have cached content
          if (hasPWACache) {
            const banner = document.querySelector('.pwa-banner');
            if (banner && banner.style.display === 'none') {
              banner.style.display = 'flex';
            }
          }
        });
      }
    }

    // Register service worker for all pages
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker
          .register('/letters/sw.js', { scope: '/letters/' })
          .then((registration) => {
            console.log('SW registered:', registration);
          })
          .catch((error) => {
            console.log('SW registration failed:', error);
          });
      });
    }
  </script>
</body>
</html>