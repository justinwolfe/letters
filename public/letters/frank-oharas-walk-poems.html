<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="frank o&#039;hara&#039;s walk poems">
  <title>frank o&#039;hara&#039;s walk poems - Thank You Notes</title>
  <link rel="manifest" href="/letters/manifest.json">
  <meta name="theme-color" content="#007bff">
  <link rel="apple-touch-icon" href="/letters/icon-192.png">
  <style>
    /**
 * Shared Styles for Thank You Notes
 * Used by both the static site and PWA version
 */

/* Base Reset and Layout */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  background: #f5f5f5;
  color: #333;
  line-height: 1.6;
}

.container {
  max-width: 900px;
  margin: 0 auto;
  padding: 2rem 1rem;
}

/* Loading and Error States */
.loading,
.error {
  text-align: center;
  padding: 3rem;
  font-size: 1.2rem;
}

.error {
  color: #dc3545;
}

/* Header */
.header {
  margin-bottom: 1.5rem;
  text-align: center;
}

.header h1 {
  font-size: 2.5rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  color: #1a1a1a;
}

.subtitle {
  font-size: 1rem;
  color: #666;
}

/* Controls */
.controls {
  margin-bottom: 2rem;
}

.search-container {
  position: relative;
  margin-bottom: 1rem;
}

.search-input {
  width: 100%;
  padding: 0.75rem 2.5rem 0.75rem 1rem;
  font-size: 1rem;
  border: 2px solid #dee2e6;
  border-radius: 8px;
  outline: none;
  transition: border-color 0.2s;
  background: white;
}

.search-input:focus {
  border-color: #007bff;
}

.clear-search {
  position: absolute;
  right: 0.75rem;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  font-size: 1.25rem;
  color: #6c757d;
  cursor: pointer;
  padding: 0.25rem 0.5rem;
  line-height: 1;
  transition: color 0.2s;
}

.clear-search:hover {
  color: #333;
}

.control-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 1rem;
  flex-wrap: wrap;
}

.sort-container {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.sort-container label {
  font-size: 0.875rem;
  font-weight: 500;
  color: #666;
}

.sort-select {
  padding: 0.5rem 0.75rem;
  font-size: 0.875rem;
  border: 2px solid #dee2e6;
  border-radius: 6px;
  background: white;
  cursor: pointer;
  outline: none;
  transition: border-color 0.2s;
}

.sort-select:focus {
  border-color: #007bff;
}

.result-count {
  font-size: 0.875rem;
  font-weight: 600;
  color: #495057;
  padding: 0.5rem 0.75rem;
  background: #e9ecef;
  border-radius: 6px;
  white-space: nowrap;
}

.btn-random {
  background: #28a745;
  color: white;
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 6px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
  white-space: nowrap;
}

.btn-random:hover {
  background: #218838;
  transform: translateY(-1px);
}

.btn-random:active {
  transform: translateY(0);
}

.searching,
.no-results {
  text-align: center;
  padding: 3rem 1rem;
  font-size: 1.1rem;
  color: #666;
}

/* Email/Letter List */
.list,
.letter-list {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

.email-card,
.letter-card {
  background: white;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  cursor: pointer;
  transition: transform 0.2s, box-shadow 0.2s;
  text-decoration: none;
  color: inherit;
  display: block;
}

.email-card:hover,
.letter-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.email-card-image {
  width: 100%;
  height: 200px;
  overflow: hidden;
  background: #e9ecef;
}

.email-card-image img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.email-card-content,
.letter-card {
  padding: 1.5rem;
}

.email-card h2,
.letter-card h2 {
  font-size: 1.5rem;
  margin-bottom: 0.5rem;
  color: #1a1a1a;
  font-weight: 600;
}

.email-description,
.letter-card p {
  color: #666;
  margin-bottom: 0.75rem;
  line-height: 1.5;
}

.email-search-snippet {
  color: #555;
  margin-bottom: 0.75rem;
  line-height: 1.5;
  font-style: italic;
}

.search-highlight {
  background: #fff3cd;
  color: #856404;
  font-weight: 700;
  padding: 0.1rem 0.2rem;
  border-radius: 3px;
  font-style: normal;
}

.email-date,
.letter-card time {
  display: block;
  font-size: 0.875rem;
  color: #888;
}

/* Email/Letter Reader */
.email-reader,
.letter-content {
  background: white;
  border-radius: 8px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  overflow: hidden;
  margin-bottom: 2rem;
}

.email-reader {
  touch-action: pan-y pinch-zoom;
}

.reader-nav,
.navigation {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem 1.5rem;
  background: #f8f9fa;
  border-bottom: 1px solid #dee2e6;
  gap: 1rem;
  flex-wrap: wrap;
}

.reader-nav-bottom {
  border-top: 1px solid #dee2e6;
  border-bottom: none;
}

.nav-buttons,
.nav-links {
  display: flex;
  gap: 0.5rem;
  flex-wrap: wrap;
}

/* Buttons */
.btn {
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
  text-decoration: none;
  display: inline-block;
}

.btn:hover {
  transform: translateY(-1px);
}

.btn:active {
  transform: translateY(0);
}

.btn-secondary {
  background: #6c757d;
  color: white;
}

.btn-secondary:hover {
  background: #5a6268;
}

.btn-nav {
  background: #007bff;
  color: white;
}

.btn-nav:hover {
  background: #0056b3;
}

.btn-back-arrow {
  background: none;
  border: none;
  color: #333;
  cursor: pointer;
  padding: 0.25rem 0.5rem;
  transition: color 0.2s, transform 0.1s;
  line-height: 1;
}

.btn-back-arrow:hover {
  color: #007bff;
  transform: translateX(-2px);
}

.btn-back-arrow:active {
  transform: translateX(0);
}

/* Email/Letter Content */
.email-content,
.letter-content {
  padding: 2rem 1.5rem;
}

.email-header,
.letter-header {
  margin-bottom: 2rem;
  padding-bottom: 1.5rem;
  border-bottom: 2px solid #e9ecef;
}

.email-header h1,
.letter-header h1 {
  font-size: 2rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  color: #1a1a1a;
  line-height: 1.3;
}

.email-header .email-date,
.letter-header time {
  font-size: 1rem;
  color: #666;
}

/* Email/Letter Body Styles */
.email-body,
.letter-body {
  font-size: 1.0625rem;
  line-height: 1.7;
  color: #333;
}

.email-body h1,
.email-body h2,
.email-body h3,
.email-body h4,
.email-body h5,
.email-body h6,
.letter-body h1,
.letter-body h2,
.letter-body h3,
.letter-body h4,
.letter-body h5,
.letter-body h6 {
  margin-top: 1.5rem;
  margin-bottom: 0.75rem;
  font-weight: 600;
  color: #1a1a1a;
  line-height: 1.3;
}

.email-body h1,
.letter-body h1 {
  font-size: 1.875rem;
}

.email-body h2,
.letter-body h2 {
  font-size: 1.5rem;
}

.email-body h3,
.letter-body h3 {
  font-size: 1.25rem;
}

.email-body p,
.letter-body p {
  margin-bottom: 1rem;
}

.email-body a,
.letter-body a {
  color: #007bff;
  text-decoration: none;
}

.email-body a:hover,
.letter-body a:hover {
  text-decoration: underline;
}

.email-body img,
.letter-body img {
  max-width: 100%;
  height: auto;
  border-radius: 4px;
  margin: 1.5rem 0;
}

.email-body ul,
.email-body ol,
.letter-body ul,
.letter-body ol {
  margin-bottom: 1rem;
  padding-left: 2rem;
}

.email-body li,
.letter-body li {
  margin-bottom: 0.5rem;
}

.email-body blockquote,
.letter-body blockquote {
  margin: 1.5rem 0;
  padding-left: 1rem;
  border-left: 4px solid #e9ecef;
  color: #666;
  font-style: italic;
}

.email-body code,
.letter-body code {
  background: #f8f9fa;
  padding: 0.2rem 0.4rem;
  border-radius: 3px;
  font-family: 'Courier New', monospace;
  font-size: 0.9em;
}

.email-body pre,
.letter-body pre {
  background: #f8f9fa;
  padding: 1rem;
  border-radius: 4px;
  overflow-x: auto;
  margin: 1.5rem 0;
}

.email-body pre code,
.letter-body pre code {
  background: none;
  padding: 0;
}

.email-body hr,
.letter-body hr {
  border: none;
  border-top: 2px solid #e9ecef;
  margin: 2rem 0;
}

/* PWA Banner */
.pwa-banner {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 1rem;
  border-radius: 8px;
  margin: 1rem 0 2rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 1rem;
  flex-wrap: wrap;
}

.pwa-banner-text {
  flex: 1;
  min-width: 200px;
}

.pwa-banner-text h3 {
  margin-bottom: 0.25rem;
  font-size: 1.1rem;
}

.pwa-banner-text p {
  font-size: 0.9rem;
  opacity: 0.9;
}

.btn-primary {
  background: #007bff;
  color: white;
  padding: 0.75rem 1.25rem;
  border: none;
  border-radius: 6px;
  font-size: 0.9375rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
}

.btn-primary:hover {
  background: #0056b3;
  transform: translateY(-1px);
}

.btn-primary:active {
  transform: translateY(0);
}

.btn-primary:disabled {
  background: #6c757d;
  cursor: not-allowed;
  transform: none;
}

.btn-danger {
  background: #dc3545;
  color: white;
  padding: 0.75rem 1.25rem;
  border: none;
  border-radius: 6px;
  font-size: 0.9375rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
}

.btn-danger:hover {
  background: #c82333;
  transform: translateY(-1px);
}

.btn-danger:active {
  transform: translateY(0);
}

/* Offline & PWA UI */
.offline-banner {
  background: #ff9800;
  color: white;
  padding: 0.75rem 1rem;
  text-align: center;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-weight: 500;
}

.download-progress {
  background: white;
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.download-progress-bar {
  height: 8px;
  background: #e9ecef;
  border-radius: 4px;
  overflow: hidden;
  margin-bottom: 0.5rem;
}

.download-progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #007bff, #0056b3);
  transition: width 0.3s ease;
}

.download-progress p {
  font-size: 0.875rem;
  color: #666;
  text-align: center;
  margin: 0;
}

.btn-offline {
  background: #6c757d;
  color: white;
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 6px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
  white-space: nowrap;
}

.btn-offline:hover {
  background: #5a6268;
  transform: translateY(-1px);
}

.btn-offline:active {
  transform: translateY(0);
}

.offline-panel {
  background: white;
  padding: 1.5rem;
  border-radius: 8px;
  margin-bottom: 1.5rem;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.offline-panel h3 {
  margin-bottom: 1rem;
  color: #1a1a1a;
  font-size: 1.25rem;
}

.offline-stats {
  background: #f8f9fa;
  padding: 1rem;
  border-radius: 6px;
  margin-bottom: 1rem;
}

.offline-stats p {
  margin: 0.5rem 0;
  color: #495057;
  font-size: 0.9375rem;
}

.offline-actions {
  display: flex;
  gap: 0.75rem;
  margin-bottom: 1rem;
  flex-wrap: wrap;
}

.offline-note {
  font-size: 0.875rem;
  color: #666;
  line-height: 1.5;
  margin: 0;
  font-style: italic;
}

/* Responsive Design */
@media (max-width: 768px) {
  .container {
    padding: 1rem 0.5rem;
  }

  .header h1 {
    font-size: 2rem;
  }

  .control-row {
    flex-direction: column;
    align-items: stretch;
  }

  .sort-container {
    width: 100%;
    justify-content: space-between;
  }

  .sort-select {
    flex: 1;
  }

  .result-count {
    text-align: center;
  }

  .btn-random {
    width: 100%;
  }

  .email-card-content {
    padding: 1rem;
  }

  .email-card h2 {
    font-size: 1.25rem;
  }

  .email-content,
  .letter-content {
    padding: 1.5rem 1rem;
  }

  .email-header h1,
  .letter-header h1 {
    font-size: 1.5rem;
  }

  .reader-nav,
  .navigation {
    flex-direction: column;
    align-items: stretch;
  }

  .nav-buttons,
  .nav-links {
    flex-direction: column;
  }

  .btn {
    width: 100%;
    text-align: center;
  }

  .btn-nav {
    font-size: 0.8125rem;
    white-space: normal;
    word-wrap: break-word;
  }

  body {
    padding: 10px;
  }

  .pwa-banner {
    flex-direction: column;
    text-align: center;
  }
}

@media (max-width: 480px) {
  .email-card-image {
    height: 150px;
  }

  .email-body,
  .letter-body {
    font-size: 1rem;
  }
}

    
    /* Static site specific adjustments */
    body {
      padding: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    
    <div class="pwa-banner" style="display: none;">
      <div class="pwa-banner-text">
        <h3>📱 Read Offline</h3>
        <p>Install the app to read all letters offline</p>
      </div>
      <div>
        <button class="btn btn-primary" onclick="installPWA()">Install App</button>
      </div>
    </div>

    <article class="letter-content">
      <header class="letter-header">
        <h1>frank o&#039;hara&#039;s walk poems</h1>
        <time datetime="2024-03-25T15:06:42.842794Z">March 25, 2024</time>
      </header>

      <div class="letter-body">
        <p>i&#39;m thankful that though i had a really weird and unpleasant spike of nausea on friday afternoon that made it impossible for a while to think of anything but the nausea and which i can&#39;t identify a source for it eventually passed and i felt okay again. </p>
<p> <img src="/letters/images/309.jpg" alt="image.png"> </p>
<p>i&#39;m thankful for the book <em><a href="https://www.goodreads.com/book/show/197063361-in-ascension">in ascension</a></em> by martin macinnes, which is about a microbiologist who experiences something strange and trasncendent in a mysterious crater in the middle of the ocean, would recommend if you like any of: the movie <em>interstellar</em> (see also <a href="https://omny.fm/shows/poog-with-kate-berlant-and-jacqueline-novak/poogstellar">poogstellar</a>), the book or movie of <em>contact</em> by carl sagan, (the first part of) <em>seveneves</em> by neal stephenson, or <em>the book of strange new things</em> by michel faber.</p>
<p> <img src="/letters/images/308.jpg" alt="image.png">  </p>
<p>i&#39;m thankful for so many of the ux decisions in the poker roguelike game balatro (though one i feel is missing is an inability to with one buttoninvert your current card selection in your hand), but i think my favorite one is that after you play every hand, knowing that you have so many hands to earn a certain amount of money, you&#39;re watching the score get multiplied and subtotaled with a satisfying slot machine animation and if in one single hand you earn the amount of money that you need to earn in five hands, flames rise out of the numbers in the counter signaling this visually and it&#39;s so viscerally satisfying to see them. </p>
<p> <img src="/letters/images/306.jpg" alt="image.png"> </p>
<p>i&#39;m thankful we went to the mall yesterday, the first time i have been to a mall in some time, which reminds me of when we lived in bloomington and and saturdays were often the day for taking a long walk from our apartment across town to the mall/target (really the only place to go) and then, after a brief lunch and browse, walking back home (often by a different route than the way we came, for variety). i&#39;m thankful for all of the quality time with deborah, for the exercise of the long walk, for the granular experience of various weather conditions and wind patterns and states of being.</p>
<p> <img src="/letters/images/310.jpg" alt="image.png"> </p>
<p>i&#39;m thankful because of walks like these and runs by myself and for how well over time i came to know the geography of bloomington, how i could generally orient myself pretty well wherever i was in town. as a lifelong pedestrian, i&#39;m thankful to reject the secondary definition of &quot;pedestrian&quot; as boring/dull (and, while <a href="https://www.merriam-webster.com/wordplay/pedestrian-word-history-usage-dull-commonplace">looking it up</a>, to have learned about how the term exists in dialogue with &quot;equestrian&quot;). </p>
<p><img src="/letters/images/307.png" alt="image.png"> </p>
<p>i&#39;m thankful for frank o&#39;hara&#39;s &quot;walk&quot; poems like <a href="https://www.poetryfoundation.org/poems/42662/a-step-away-from-them">&quot;a step away from them&quot;</a> and <a href="https://www.poetryfoundation.org/poems/42657/the-day-lady-died">&quot;the day lady died&quot;</a> and <a href="https://www.poetryfoundation.org/poetrymagazine/browse?contentId=31122">&quot;walking&quot;</a> and, especially for monday morning, <a href="https://www.poetryfoundation.org/poetrymagazine/browse?contentId=31121">&quot;walking to work&quot;</a>:</p>
<p> <img src="/letters/images/311.jpg" alt="image.png"> </p>
<p>i&#39;m thankful, as someone who works from home (and by that i really mean &quot;from home&quot; i have never been successful at cafe life) and stays inside all the time in the winter, for the sudden vast expansion of my local world that comes with outdoor walks and runs in the spring and summer, to refamiliarize myself with the territory and criss-cross it with new routes and variations on old ones. i&#39;m thankful that my new running shoes came and just trying them inside the house makes apparent the degree to which their design (incredibly light with a very thick sole that tapers toward the toe, pushing you forward more as your foot pushes off into the next stride) might aid fast, smooth running, i&#39;m intrigued.</p>
<p> <img src="/letters/images/315.jpg" alt="image.png"> </p>
<p>i&#39;m thankful for what i think of as the &quot;interregnum&quot;, which is the brief period in the early spring and the early fall when it&#39;s warm enough that the heat doesn&#39;t need to be on constantly but cool enough that the air conditioning doesn&#39;t need to be on constantly and there is beautiful perfect quiet and my brain, in the absence of these irritants, is able to rest (i&#39;m thankful, outside of the interregnum, for ear plugs and noise-cancelling headphones, which never work as well as i want them to but also are things i can&#39;t imagine living without). i&#39;m thankful to remind myself, as i thirst for summer, that the interregnum is brief and i should hold on to it rather than rushing through.</p>
<p> <img src="/letters/images/312.jpg" alt="image.png"> </p>
<p>i&#39;m thankful it&#39;s okay that at the buzzy and deeply understaffed <a href="https://www.yelp.com/biz/coredam-beaverton">korean restaurant in beaverton</a> we tried with friends saturday evening we made the mistake of assuming that the prices were high and the portions were normal when actually we came to find out that we were all unintentionally ordering a crazy mukbang amount of food. i&#39;m thankful they had plentiful to-go containers (so we have leftovers for lunch today) and i&#39;m thankful that k gave me an extra napkin after the first time i made a total mess of myself trying to eat raw marinated crab without gloves (i would make a total mess of myself several more times across the course of the meal, so i am also thankful that they had clean bathrooms). i&#39;m thankful that they had really good panchan (including a mustardy seaweed that i had in korea but don&#39;t see very often) which honestly i could have just eaten slightly larger portions of with rice and been perfectly happy with.</p>
<p> <img src="/letters/images/313.jpg" alt="image.png"> </p>
<p>i&#39;m thankful, killing time before the restaurant opened (i&#39;m thankful for friends who also like eating dinner early), that ec saw a barcade and we went in and played buck hunter (where v got multiple high scores on the leaderboard), mario kart, donkey kong, and metallica and AC/DC pinball. i&#39;m thankful that d has rekindled her addiction to <a href="https://www.nintendo.com/us/store/products/cobalt-core-switch/">cobalt core</a>. i&#39;m thankful that in the car we listened to the newly released bonus tracks from the olivia rodrigo album, even though my review of them was that sometimes tracks don&#39;t make the album because they&#39;re just not very good and i do not plan to listen to any of them ever again. i&#39;m thankful for ec&#39;s almost painful love of hozier. i&#39;m thankful at sephora i saw a girl wearing jncos and a new yorker tote bag. i&#39;m thankful for flatwound bass strings, which just feel so much better than roundwound. </p>
<p><img src="/letters/images/314.jpg" alt="image.png"> </p>
<p>i&#39;m thankful for the bluetooth protocol, even though at exactly 2am last night someone at the neighbors&#39; party attempting to connect to their speakers inadvertently connected to the speakers in our bedroom and woke us up with the sudden music, a song i could not immediately place because of the disorientation of sleep but which now i wish i knew what it was so i could mention it here. i&#39;m thankful that though this experience disrupted and kicked off a cascade of weird dreams throughout the night</p>
<h2>Previously on this day:</h2>
<ul>
<li><a href="https://buttondown.email/justinwolfe/archive/thank-you-notes-325/">2016</a> (<em>faint aura of manic panic, reruns of sex and the city in the hospital, the pleasure of anaesthesia</em>)</li>
<li><a href="https://buttondown.email/justinwolfe/archive/32517/">2017</a> (<em>above 60 degrees outside at 9 am, band practice and yoga practice, &quot;chanel&quot; by frank ocean</em>)</li>
<li><a href="https://buttondown.email/justinwolfe/archive/32518/">2018</a> (<em>&quot;for these drop biscuits (but really, for any biscuits)&quot;</em>)</li>
<li><a href="https://buttondown.email/justinwolfe/archive/324-2482/">2019</a> (<em>long letter to d and a good talk, &quot;how writing these notes for so long has strengthened my ability to communicate my feelings&quot;, there is a single falcon feather on the moon</em>)</li>
<li><a href="https://buttondown.email/justinwolfe/archive/32520/">2020</a> (<em>new hot water heater</em>)</li>
<li><a href="https://buttondown.email/justinwolfe/archive/sign-of-the-times/">2021</a> (<em>taking a mental health day from work, outtake of deborah and i playing &quot;sign of the times&quot;</em>)</li>
</ul>

      </div>
    </article>

    <nav class="navigation">
      <a href="/letters/" class="btn btn-secondary">home</a>
      <div class="nav-links">
        <a href="/letters/letters/out-of-memory.html" class="btn btn-secondary">← out of memory</a>
        <a href="/letters/letters/the-dream-of-spoiler-free-search.html" class="btn btn-secondary">the dream of spoiler-free search →</a>
      </div>
    </nav>
  
  </div>

  <script>
    // PWA installation prompt
    let deferredPrompt;

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      
      const banner = document.querySelector('.pwa-banner');
      if (banner) {
        banner.style.display = 'flex';
      }
    });

    async function installPWA() {
      if (!deferredPrompt) {
        // If not installable, redirect to PWA
        window.location.href = '/letters/app/';
        return;
      }

      deferredPrompt.prompt();
      const { outcome } = await deferredPrompt.userChoice;
      
      if (outcome === 'accepted') {
        console.log('PWA installed');
      }
      
      deferredPrompt = null;
      const banner = document.querySelector('.pwa-banner');
      if (banner) {
        banner.style.display = 'none';
      }
    }

    function openPWA() {
      window.location.href = '/letters/app/';
    }

    // Progressive Enhancement: Check if user has PWA installed
    // If they do, redirect them to the app version for a richer experience
    if (window.matchMedia('(display-mode: standalone)').matches) {
      // User is in standalone mode (PWA is installed and running)
      // Keep them on static page - they're already in PWA mode
      console.log('Running in PWA mode');
    } else {
      // Check if user has previously used the PWA (has cached data)
      if ('caches' in window) {
        caches.keys().then(cacheNames => {
          const hasPWACache = cacheNames.some(name => 
            name.includes('static-') || name.includes('data-')
          );
          
          // Only show PWA banner if they have cached content
          if (hasPWACache) {
            const banner = document.querySelector('.pwa-banner');
            if (banner && banner.style.display === 'none') {
              banner.style.display = 'flex';
            }
          }
        });
      }
    }

    // Register service worker for all pages
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker
          .register('/letters/sw.js', { scope: '/letters/' })
          .then((registration) => {
            console.log('SW registered:', registration);
          })
          .catch((error) => {
            console.log('SW registration failed:', error);
          });
      });
    }
  </script>
</body>
</html>