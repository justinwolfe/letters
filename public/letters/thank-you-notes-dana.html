<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="thank you notes (dana)">
  <title>thank you notes (dana) - Thank You Notes</title>
  <link rel="manifest" href="/letters/manifest.json">
  <meta name="theme-color" content="#007bff">
  <link rel="apple-touch-icon" href="/letters/icon-192.png">
  <style>
    /**
 * Shared Styles for Thank You Notes
 * Used by both the static site and PWA version
 */

/* Base Reset and Layout */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  background: #f5f5f5;
  color: #333;
  line-height: 1.6;
}

.container {
  max-width: 900px;
  margin: 0 auto;
  padding: 2rem 1rem;
}

/* Loading and Error States */
.loading,
.error {
  text-align: center;
  padding: 3rem;
  font-size: 1.2rem;
}

.error {
  color: #dc3545;
}

/* Header */
.header {
  margin-bottom: 1.5rem;
  text-align: center;
}

.header h1 {
  font-size: 2.5rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  color: #1a1a1a;
}

.subtitle {
  font-size: 1rem;
  color: #666;
}

/* Controls */
.controls {
  margin-bottom: 2rem;
}

.search-container {
  position: relative;
  margin-bottom: 1rem;
}

.search-input {
  width: 100%;
  padding: 0.75rem 2.5rem 0.75rem 1rem;
  font-size: 1rem;
  border: 2px solid #dee2e6;
  border-radius: 8px;
  outline: none;
  transition: border-color 0.2s;
  background: white;
}

.search-input:focus {
  border-color: #007bff;
}

.clear-search {
  position: absolute;
  right: 0.75rem;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  font-size: 1.25rem;
  color: #6c757d;
  cursor: pointer;
  padding: 0.25rem 0.5rem;
  line-height: 1;
  transition: color 0.2s;
}

.clear-search:hover {
  color: #333;
}

.control-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 1rem;
  flex-wrap: wrap;
}

.sort-container {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.sort-container label {
  font-size: 0.875rem;
  font-weight: 500;
  color: #666;
}

.sort-select {
  padding: 0.5rem 0.75rem;
  font-size: 0.875rem;
  border: 2px solid #dee2e6;
  border-radius: 6px;
  background: white;
  cursor: pointer;
  outline: none;
  transition: border-color 0.2s;
}

.sort-select:focus {
  border-color: #007bff;
}

.result-count {
  font-size: 0.875rem;
  font-weight: 600;
  color: #495057;
  padding: 0.5rem 0.75rem;
  background: #e9ecef;
  border-radius: 6px;
  white-space: nowrap;
}

.btn-random {
  background: #28a745;
  color: white;
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 6px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
  white-space: nowrap;
}

.btn-random:hover {
  background: #218838;
  transform: translateY(-1px);
}

.btn-random:active {
  transform: translateY(0);
}

.searching,
.no-results {
  text-align: center;
  padding: 3rem 1rem;
  font-size: 1.1rem;
  color: #666;
}

/* Email/Letter List */
.list,
.letter-list {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

.email-card,
.letter-card {
  background: white;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  cursor: pointer;
  transition: transform 0.2s, box-shadow 0.2s;
  text-decoration: none;
  color: inherit;
  display: block;
}

.email-card:hover,
.letter-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.email-card-image {
  width: 100%;
  height: 200px;
  overflow: hidden;
  background: #e9ecef;
}

.email-card-image img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.email-card-content,
.letter-card {
  padding: 1.5rem;
}

.email-card h2,
.letter-card h2 {
  font-size: 1.5rem;
  margin-bottom: 0.5rem;
  color: #1a1a1a;
  font-weight: 600;
}

.email-description,
.letter-card p {
  color: #666;
  margin-bottom: 0.75rem;
  line-height: 1.5;
}

.email-search-snippet {
  color: #555;
  margin-bottom: 0.75rem;
  line-height: 1.5;
  font-style: italic;
}

.search-highlight {
  background: #fff3cd;
  color: #856404;
  font-weight: 700;
  padding: 0.1rem 0.2rem;
  border-radius: 3px;
  font-style: normal;
}

.email-date,
.letter-card time {
  display: block;
  font-size: 0.875rem;
  color: #888;
}

/* Email/Letter Reader */
.email-reader,
.letter-content {
  background: white;
  border-radius: 8px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  overflow: hidden;
  margin-bottom: 2rem;
}

.email-reader {
  touch-action: pan-y pinch-zoom;
}

.reader-nav,
.navigation {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem 1.5rem;
  background: #f8f9fa;
  border-bottom: 1px solid #dee2e6;
  gap: 1rem;
  flex-wrap: wrap;
}

.reader-nav-bottom {
  border-top: 1px solid #dee2e6;
  border-bottom: none;
}

.nav-buttons,
.nav-links {
  display: flex;
  gap: 0.5rem;
  flex-wrap: wrap;
}

/* Buttons */
.btn {
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
  text-decoration: none;
  display: inline-block;
}

.btn:hover {
  transform: translateY(-1px);
}

.btn:active {
  transform: translateY(0);
}

.btn-secondary {
  background: #6c757d;
  color: white;
}

.btn-secondary:hover {
  background: #5a6268;
}

.btn-nav {
  background: #007bff;
  color: white;
}

.btn-nav:hover {
  background: #0056b3;
}

.btn-back-arrow {
  background: none;
  border: none;
  color: #333;
  cursor: pointer;
  padding: 0.25rem 0.5rem;
  transition: color 0.2s, transform 0.1s;
  line-height: 1;
}

.btn-back-arrow:hover {
  color: #007bff;
  transform: translateX(-2px);
}

.btn-back-arrow:active {
  transform: translateX(0);
}

/* Email/Letter Content */
.email-content,
.letter-content {
  padding: 2rem 1.5rem;
}

.email-header,
.letter-header {
  margin-bottom: 2rem;
  padding-bottom: 1.5rem;
  border-bottom: 2px solid #e9ecef;
}

.email-header h1,
.letter-header h1 {
  font-size: 2rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  color: #1a1a1a;
  line-height: 1.3;
}

.email-header .email-date,
.letter-header time {
  font-size: 1rem;
  color: #666;
}

/* Email/Letter Body Styles */
.email-body,
.letter-body {
  font-size: 1.0625rem;
  line-height: 1.7;
  color: #333;
}

.email-body h1,
.email-body h2,
.email-body h3,
.email-body h4,
.email-body h5,
.email-body h6,
.letter-body h1,
.letter-body h2,
.letter-body h3,
.letter-body h4,
.letter-body h5,
.letter-body h6 {
  margin-top: 1.5rem;
  margin-bottom: 0.75rem;
  font-weight: 600;
  color: #1a1a1a;
  line-height: 1.3;
}

.email-body h1,
.letter-body h1 {
  font-size: 1.875rem;
}

.email-body h2,
.letter-body h2 {
  font-size: 1.5rem;
}

.email-body h3,
.letter-body h3 {
  font-size: 1.25rem;
}

.email-body p,
.letter-body p {
  margin-bottom: 1rem;
}

.email-body a,
.letter-body a {
  color: #007bff;
  text-decoration: none;
}

.email-body a:hover,
.letter-body a:hover {
  text-decoration: underline;
}

.email-body img,
.letter-body img {
  max-width: 100%;
  height: auto;
  border-radius: 4px;
  margin: 1.5rem 0;
}

.email-body ul,
.email-body ol,
.letter-body ul,
.letter-body ol {
  margin-bottom: 1rem;
  padding-left: 2rem;
}

.email-body li,
.letter-body li {
  margin-bottom: 0.5rem;
}

.email-body blockquote,
.letter-body blockquote {
  margin: 1.5rem 0;
  padding-left: 1rem;
  border-left: 4px solid #e9ecef;
  color: #666;
  font-style: italic;
}

.email-body code,
.letter-body code {
  background: #f8f9fa;
  padding: 0.2rem 0.4rem;
  border-radius: 3px;
  font-family: 'Courier New', monospace;
  font-size: 0.9em;
}

.email-body pre,
.letter-body pre {
  background: #f8f9fa;
  padding: 1rem;
  border-radius: 4px;
  overflow-x: auto;
  margin: 1.5rem 0;
}

.email-body pre code,
.letter-body pre code {
  background: none;
  padding: 0;
}

.email-body hr,
.letter-body hr {
  border: none;
  border-top: 2px solid #e9ecef;
  margin: 2rem 0;
}

/* PWA Banner */
.pwa-banner {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 1rem;
  border-radius: 8px;
  margin: 1rem 0 2rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 1rem;
  flex-wrap: wrap;
}

.pwa-banner-text {
  flex: 1;
  min-width: 200px;
}

.pwa-banner-text h3 {
  margin-bottom: 0.25rem;
  font-size: 1.1rem;
}

.pwa-banner-text p {
  font-size: 0.9rem;
  opacity: 0.9;
}

.btn-primary {
  background: #007bff;
  color: white;
  padding: 0.75rem 1.25rem;
  border: none;
  border-radius: 6px;
  font-size: 0.9375rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
}

.btn-primary:hover {
  background: #0056b3;
  transform: translateY(-1px);
}

.btn-primary:active {
  transform: translateY(0);
}

.btn-primary:disabled {
  background: #6c757d;
  cursor: not-allowed;
  transform: none;
}

.btn-danger {
  background: #dc3545;
  color: white;
  padding: 0.75rem 1.25rem;
  border: none;
  border-radius: 6px;
  font-size: 0.9375rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
}

.btn-danger:hover {
  background: #c82333;
  transform: translateY(-1px);
}

.btn-danger:active {
  transform: translateY(0);
}

/* Offline & PWA UI */
.offline-banner {
  background: #ff9800;
  color: white;
  padding: 0.75rem 1rem;
  text-align: center;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-weight: 500;
}

.download-progress {
  background: white;
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.download-progress-bar {
  height: 8px;
  background: #e9ecef;
  border-radius: 4px;
  overflow: hidden;
  margin-bottom: 0.5rem;
}

.download-progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #007bff, #0056b3);
  transition: width 0.3s ease;
}

.download-progress p {
  font-size: 0.875rem;
  color: #666;
  text-align: center;
  margin: 0;
}

.btn-offline {
  background: #6c757d;
  color: white;
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 6px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
  white-space: nowrap;
}

.btn-offline:hover {
  background: #5a6268;
  transform: translateY(-1px);
}

.btn-offline:active {
  transform: translateY(0);
}

.offline-panel {
  background: white;
  padding: 1.5rem;
  border-radius: 8px;
  margin-bottom: 1.5rem;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.offline-panel h3 {
  margin-bottom: 1rem;
  color: #1a1a1a;
  font-size: 1.25rem;
}

.offline-stats {
  background: #f8f9fa;
  padding: 1rem;
  border-radius: 6px;
  margin-bottom: 1rem;
}

.offline-stats p {
  margin: 0.5rem 0;
  color: #495057;
  font-size: 0.9375rem;
}

.offline-actions {
  display: flex;
  gap: 0.75rem;
  margin-bottom: 1rem;
  flex-wrap: wrap;
}

.offline-note {
  font-size: 0.875rem;
  color: #666;
  line-height: 1.5;
  margin: 0;
  font-style: italic;
}

/* Responsive Design */
@media (max-width: 768px) {
  .container {
    padding: 1rem 0.5rem;
  }

  .header h1 {
    font-size: 2rem;
  }

  .control-row {
    flex-direction: column;
    align-items: stretch;
  }

  .sort-container {
    width: 100%;
    justify-content: space-between;
  }

  .sort-select {
    flex: 1;
  }

  .result-count {
    text-align: center;
  }

  .btn-random {
    width: 100%;
  }

  .email-card-content {
    padding: 1rem;
  }

  .email-card h2 {
    font-size: 1.25rem;
  }

  .email-content,
  .letter-content {
    padding: 1.5rem 1rem;
  }

  .email-header h1,
  .letter-header h1 {
    font-size: 1.5rem;
  }

  .reader-nav,
  .navigation {
    flex-direction: column;
    align-items: stretch;
  }

  .nav-buttons,
  .nav-links {
    flex-direction: column;
  }

  .btn {
    width: 100%;
    text-align: center;
  }

  .btn-nav {
    font-size: 0.8125rem;
    white-space: normal;
    word-wrap: break-word;
  }

  body {
    padding: 10px;
  }

  .pwa-banner {
    flex-direction: column;
    text-align: center;
  }
}

@media (max-width: 480px) {
  .email-card-image {
    height: 150px;
  }

  .email-body,
  .letter-body {
    font-size: 1rem;
  }
}


    
    /* Static site specific adjustments */
    body {
      padding: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    
    <div class="pwa-banner" style="display: none;">
      <div class="pwa-banner-text">
        <h3>üì± Read Offline</h3>
        <p>Install the app to read all letters offline</p>
      </div>
      <div>
        <button class="btn btn-primary" onclick="installPWA()">Install App</button>
      </div>
    </div>

    <article class="letter-content">
      <header class="letter-header">
        <h1>thank you notes (dana)</h1>
        <time datetime="2016-06-04T00:00:00Z">June 3, 2016</time>
      </header>

      <div class="letter-body">
        <p>[ed:¬†<em>i&#39;m thankful for the opportunity to share some recent thank you notes by <a href="https://twitter.com/danaanmm">dana,</a> who posts <a href="https://danaanm.tumblr.com/">daily notes on her tumblr</a>, which is wonderful. if you&#39;d like to submit notes for me to share, you can do so <a href="https://docs.google.com/forms/d/1X6z1T5sSBXxFpfGI7gPZzQIp_qgkDCsVVCLV4yrw1a4/viewform">here</a>.</em>]</p>
<p>5/18</p>
<p>I‚Äôm thankful that I tried meditating in the morning for ten minutes. I‚Äôm thankful that I found the setting on my phone that turns off all alerts except alarms because it tends to buzz and beep more in the morning. I‚Äôm thankful that as I tried to focus on my breathing my stomach kept growling and it made me laugh as in <em>Of course you would start making noise just when I‚Äôm trying to be quiet</em>. I‚Äôm thankful that my stomach was probably growling because I was thinking of what I was going to order for breakfast at the cafe with N and F. I‚Äôm thankful that an old mentor CP and I talked about meditation once and he said it was really fucking hard but always good to try. I‚Äôm thankful that for the time he shared an article with the class on mindfulness in the hope it would help us. I‚Äôm thankful for CP in general. I‚Äôm thankful that while meditating I didn‚Äôt slip into self loathing thoughts because this is where my brain often goes when it‚Äôs idle.</p>
<p>I‚Äôm thankful that on the crowded train a man was eating a roll near me and smell of his food made me more hungry and happy that I was going to eat breakfast soon at a good cafe I‚Äôve been to lots of times.</p>
<p>I‚Äôm thankful for the very cool looking tall woman dressed in all black while I waited at the station for F to pick me up so we could go to the cafe. I‚Äôm thankful for her thigh high boots, crocheted cape-like coat and short dress. I‚Äôm thankful for her long hair which was also black and the way she breezed past everyone like Miranda Priestly going to an important meeting.</p>
<p>I‚Äôm thankful that I didn‚Äôt have to wait very long for F as she is always punctual. I‚Äôm thankful that in the car I rested my hand between our two seats and at a stop light she put her hand in mine. I‚Äôm thankful that I laughed and said <em>Oh!</em> and she said <em>I thought you were giving me a signal or something!</em> and how sweet that was. I‚Äôm thankful that we held hands until she needed to turn the steering wheel. I‚Äôm thankful that she welcomes my being open with her with her own openness. I‚Äôm thankful that we regularly express gratitude for the other and this is the first friendship where I‚Äôve experienced this. I‚Äôm thankful for my adult friendships, which feel markedly different and better than my teenage ones.</p>
<p>I‚Äôm thankful for the coat I was wearing which has become my favourite coat that I got for five dollars at Target. I‚Äôm thankful that I‚Äôve been seriously thinking over the concept of a capsule wardrobe and could probably do it. I‚Äôm thankful for the many blogs and videos that exist on how to capsule-ify your wardrobe when it essentially seems very simple to me. I‚Äôm thankful for the porridge I ate that had walnuts, honey and rhubarb in it. I‚Äôm thankful for my recent decision to never ever wear heels again and how good I feel about it. I‚Äôm thankful for my deep and painful regret each time I‚Äôve worn high heels and how each time this has happened it‚Äôs cemented the lesson that took me until now to learn. I‚Äôm thankful that now whever I see women wear heels I can‚Äôt help but internally cringe at the pain they‚Äôre surely feeling or will feel later.</p>
<p>5/23</p>
<p>I‚Äôm thankful that yesterday I hung out with my young cousin L for a few hours. I‚Äôm thankful that she told me about high school and how miserable she is, that she feels comfortable sharing those things with me. I‚Äôm thankful that she calls me her best friend but very much wants a best friend of her own age and didn‚Äôt realise that it would be such a struggle to find a best friend in high school (it‚Äôs her first year). I‚Äôm thankful that she complains about everyone in her classes talking about cute boys (she goes to an all girls school) and doesn‚Äôt understand why that‚Äôs all they talk about when she wants to run and play. I‚Äôm thankful that she spoke about feeling inadequate and ugly compared to her friends and that I didn‚Äôt become impatient with her as this reaction would be something that I could easily see myself do. I‚Äôm thankful that I don‚Äôt care about what anyone thinks of me anymore and I almost said that to her: <em>L, I can‚Äôt wait for you get older because then you‚Äôll stop caring what other people think</em>. But I‚Äôm thankful that I didn‚Äôt because I believe it‚Äôs a very common experience for children to have adults dismiss their problems like this as they have the luxury of hindsight.</p>
<p>I‚Äôm thankful for her impressive emotional intelligence at the age of (nearly) 13. I‚Äôm thankful that she spoke of how it‚Äôs important to have friends and people that you can share secrets and things with so that you don‚Äôt feel alone. I‚Äôm thankful that she didn‚Äôt have the words to say <em>It‚Äôs important to have friends and family around you so they can validate and support you</em> and instead said <em>I want to feel like people care about me</em>. I‚Äôm thankful for the way children often express themselves, both very simply and sometimes incoherently because they‚Äôre dealing with things they don‚Äôt have the words to describe yet.</p>
<p>I‚Äôm thankful for my generally shitty time in high school and that I spend a lot of time when I‚Äôm volunteering in schools thinking about how I can make upset students feel better about their situation. I‚Äôm thankful for one time I got to do this with a student who was worrying about her terrible performance in math and that I told her about a really good math teacher I had who made the class really interesting to me and I got all As for the subject that year (in previous years I‚Äôd been close to failing because I hated math so much and didn‚Äôt put any effort in). I‚Äôm thankful that she told me about a teacher who had that effect for her but she was worried she‚Äôd be annoying him if she went to him for help even though he wasn‚Äôt her regular math teacher. I‚Äôm thankful I got to tell her that this wouldn‚Äôt be the case at all and he was literally being paid to help her so take advantage of it. I‚Äôm thankful that after she left I daydreamed a little about a student coming to me because they felt I had the skills to help them that other teachers didn‚Äôt have and how I could make them feel better about whatever mythical subject it was.</p>
<p>I‚Äôm thankful for my conflicting feelings about the education system in general, and for movements that exist about alternate modes of learning. I‚Äôm thankful for Steiner schools, Montessori education etc. and books like <em><a href="http://t.umblr.com/redirect?z=http%3A%2F%2Fwww.amazon.com%2FFree-Learn-Unleashing-Instinct-Self-Reliant%2Fdp%2F0465025994%2Fref%3Dsr_1_1%3Fie%3DUTF8%26qid%3D1421370498%26sr%3D8-1%26keywords%3Dpeter+gray&t=NTFjNGUwNmU0NDY4MjEzNmJlNzcyZjkzOTJjYWI4MTFiNjI3OTk5YyxSdlpMaHVKZg%3D%3D">Free To Learn</a></em>.</p>
<p>I‚Äôm thankful that L tells me things she doesn‚Äôt tell her parents because they are rather strict and very small minded (I don‚Äôt know how to word that without sounding mean lol). I‚Äôm thankful that when they had to leave we decided we would message each other on Skype and Instagram. I‚Äôm thankful for the instant bonding that comes with secrecy.</p>
<p>6/3</p>
<p>I‚Äôm thankful that I nearly forgot to write this. I‚Äôm thankful for time and that I have plenty of it (even if I seem to think otherwise often).I‚Äôm thankful for my calendar and that I was late to keeping one but now the first thing I do when someone starts a sentence with Are you free on‚Ä¶ is pull out my phone and look at the GCal app.</p>
<p>I‚Äôm thankful that I felt extremely angry for most of the day, the kind where I get headaches an grind my teeth. I‚Äôm thankful that there was no real external reason for it and knowing that made it seem silly. I‚Äôm thankful that the silliness kind of diffused it. I‚Äôm thankful that GM rang and and I answered the phone with <em>Grrrrrr!</em> because I was so angry and said <em>I‚Äôm so fucking pissed off right now</em> and he said <em>Why?</em> and I couldn‚Äôt think of a response.</p>
<p>I‚Äôm thankful that in my neverending quest for zesty, tangy and spicy things I chopped up a lemon into tiny pieces, fried the pieces with chilli and salt and ate them with a handful of rice. I‚Äôm thankful for starch.</p>

      </div>
    </article>

    <nav class="navigation">
      <a href="/letters/" class="btn btn-secondary">home</a>
      <div class="nav-links">
        <a href="/letters/letters/thank-you-notes-65.html" class="btn btn-secondary">‚Üê thank you notes 6/5</a>
        <a href="/letters/letters/thank-you-notes-53.html" class="btn btn-secondary">thank you notes 5/3 ‚Üí</a>
      </div>
    </nav>
  
  </div>

  <script>
    // PWA installation prompt
    let deferredPrompt;

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      
      const banner = document.querySelector('.pwa-banner');
      if (banner) {
        banner.style.display = 'flex';
      }
    });

    async function installPWA() {
      if (!deferredPrompt) {
        // If not installable, redirect to PWA
        window.location.href = '/letters/app/';
        return;
      }

      deferredPrompt.prompt();
      const { outcome } = await deferredPrompt.userChoice;
      
      if (outcome === 'accepted') {
        console.log('PWA installed');
      }
      
      deferredPrompt = null;
      const banner = document.querySelector('.pwa-banner');
      if (banner) {
        banner.style.display = 'none';
      }
    }

    function openPWA() {
      window.location.href = '/letters/app/';
    }

    // Progressive Enhancement: Check if user has PWA installed
    // If they do, redirect them to the app version for a richer experience
    if (window.matchMedia('(display-mode: standalone)').matches) {
      // User is in standalone mode (PWA is installed and running)
      // Keep them on static page - they're already in PWA mode
      console.log('Running in PWA mode');
    } else {
      // Check if user has previously used the PWA (has cached data)
      if ('caches' in window) {
        caches.keys().then(cacheNames => {
          const hasPWACache = cacheNames.some(name => 
            name.includes('static-') || name.includes('data-')
          );
          
          // Only show PWA banner if they have cached content
          if (hasPWACache) {
            const banner = document.querySelector('.pwa-banner');
            if (banner && banner.style.display === 'none') {
              banner.style.display = 'flex';
            }
          }
        });
      }
    }

    // Register service worker for all pages
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker
          .register('/letters/sw.js', { scope: '/letters/' })
          .then((registration) => {
            console.log('SW registered:', registration);
          })
          .catch((error) => {
            console.log('SW registration failed:', error);
          });
      });
    }
  </script>
</body>
</html>