<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="thank you notes 1/13">
  <title>thank you notes 1/13 - Thank You Notes</title>
  <link rel="manifest" href="/letters/manifest.json">
  <meta name="theme-color" content="#007bff">
  <link rel="apple-touch-icon" href="/letters/icon-192.png">
  <style>
    /**
 * Shared Styles for Thank You Notes
 * Used by both the static site and PWA version
 */

/* Base Reset and Layout */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  background: #f5f5f5;
  color: #333;
  line-height: 1.6;
}

.container {
  max-width: 900px;
  margin: 0 auto;
  padding: 2rem 1rem;
}

/* Loading and Error States */
.loading,
.error {
  text-align: center;
  padding: 3rem;
  font-size: 1.2rem;
}

.error {
  color: #dc3545;
}

/* Header */
.header {
  margin-bottom: 1.5rem;
  text-align: center;
}

.header h1 {
  font-size: 2.5rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  color: #1a1a1a;
}

.subtitle {
  font-size: 1rem;
  color: #666;
}

/* Controls */
.controls {
  margin-bottom: 2rem;
}

.search-container {
  position: relative;
  margin-bottom: 1rem;
}

.search-input {
  width: 100%;
  padding: 0.75rem 2.5rem 0.75rem 1rem;
  font-size: 1rem;
  border: 2px solid #dee2e6;
  border-radius: 8px;
  outline: none;
  transition: border-color 0.2s;
  background: white;
}

.search-input:focus {
  border-color: #007bff;
}

.clear-search {
  position: absolute;
  right: 0.75rem;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  font-size: 1.25rem;
  color: #6c757d;
  cursor: pointer;
  padding: 0.25rem 0.5rem;
  line-height: 1;
  transition: color 0.2s;
}

.clear-search:hover {
  color: #333;
}

.control-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 1rem;
  flex-wrap: wrap;
}

.sort-container {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.sort-container label {
  font-size: 0.875rem;
  font-weight: 500;
  color: #666;
}

.sort-select {
  padding: 0.5rem 0.75rem;
  font-size: 0.875rem;
  border: 2px solid #dee2e6;
  border-radius: 6px;
  background: white;
  cursor: pointer;
  outline: none;
  transition: border-color 0.2s;
}

.sort-select:focus {
  border-color: #007bff;
}

.result-count {
  font-size: 0.875rem;
  font-weight: 600;
  color: #495057;
  padding: 0.5rem 0.75rem;
  background: #e9ecef;
  border-radius: 6px;
  white-space: nowrap;
}

.btn-random {
  background: #28a745;
  color: white;
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 6px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
  white-space: nowrap;
}

.btn-random:hover {
  background: #218838;
  transform: translateY(-1px);
}

.btn-random:active {
  transform: translateY(0);
}

.searching,
.no-results {
  text-align: center;
  padding: 3rem 1rem;
  font-size: 1.1rem;
  color: #666;
}

/* Email/Letter List */
.list,
.letter-list {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

.email-card,
.letter-card {
  background: white;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  cursor: pointer;
  transition: transform 0.2s, box-shadow 0.2s;
  text-decoration: none;
  color: inherit;
  display: block;
}

.email-card:hover,
.letter-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.email-card-image {
  width: 100%;
  height: 200px;
  overflow: hidden;
  background: #e9ecef;
}

.email-card-image img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.email-card-content,
.letter-card {
  padding: 1.5rem;
}

.email-card h2,
.letter-card h2 {
  font-size: 1.5rem;
  margin-bottom: 0.5rem;
  color: #1a1a1a;
  font-weight: 600;
}

.email-description,
.letter-card p {
  color: #666;
  margin-bottom: 0.75rem;
  line-height: 1.5;
}

.email-search-snippet {
  color: #555;
  margin-bottom: 0.75rem;
  line-height: 1.5;
  font-style: italic;
}

.search-highlight {
  background: #fff3cd;
  color: #856404;
  font-weight: 700;
  padding: 0.1rem 0.2rem;
  border-radius: 3px;
  font-style: normal;
}

.email-date,
.letter-card time {
  display: block;
  font-size: 0.875rem;
  color: #888;
}

/* Email/Letter Reader */
.email-reader,
.letter-content {
  background: white;
  border-radius: 8px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  overflow: hidden;
  margin-bottom: 2rem;
}

.email-reader {
  touch-action: pan-y pinch-zoom;
}

.reader-nav,
.navigation {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem 1.5rem;
  background: #f8f9fa;
  border-bottom: 1px solid #dee2e6;
  gap: 1rem;
  flex-wrap: wrap;
}

.reader-nav-bottom {
  border-top: 1px solid #dee2e6;
  border-bottom: none;
}

.nav-buttons,
.nav-links {
  display: flex;
  gap: 0.5rem;
  flex-wrap: wrap;
}

/* Buttons */
.btn {
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
  text-decoration: none;
  display: inline-block;
}

.btn:hover {
  transform: translateY(-1px);
}

.btn:active {
  transform: translateY(0);
}

.btn-secondary {
  background: #6c757d;
  color: white;
}

.btn-secondary:hover {
  background: #5a6268;
}

.btn-nav {
  background: #007bff;
  color: white;
}

.btn-nav:hover {
  background: #0056b3;
}

.btn-back-arrow {
  background: none;
  border: none;
  color: #333;
  cursor: pointer;
  padding: 0.25rem 0.5rem;
  transition: color 0.2s, transform 0.1s;
  line-height: 1;
}

.btn-back-arrow:hover {
  color: #007bff;
  transform: translateX(-2px);
}

.btn-back-arrow:active {
  transform: translateX(0);
}

/* Email/Letter Content */
.email-content,
.letter-content {
  padding: 2rem 1.5rem;
}

.email-header,
.letter-header {
  margin-bottom: 2rem;
  padding-bottom: 1.5rem;
  border-bottom: 2px solid #e9ecef;
}

.email-header h1,
.letter-header h1 {
  font-size: 2rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  color: #1a1a1a;
  line-height: 1.3;
}

.email-header .email-date,
.letter-header time {
  font-size: 1rem;
  color: #666;
}

/* Email/Letter Body Styles */
.email-body,
.letter-body {
  font-size: 1.0625rem;
  line-height: 1.7;
  color: #333;
}

.email-body h1,
.email-body h2,
.email-body h3,
.email-body h4,
.email-body h5,
.email-body h6,
.letter-body h1,
.letter-body h2,
.letter-body h3,
.letter-body h4,
.letter-body h5,
.letter-body h6 {
  margin-top: 1.5rem;
  margin-bottom: 0.75rem;
  font-weight: 600;
  color: #1a1a1a;
  line-height: 1.3;
}

.email-body h1,
.letter-body h1 {
  font-size: 1.875rem;
}

.email-body h2,
.letter-body h2 {
  font-size: 1.5rem;
}

.email-body h3,
.letter-body h3 {
  font-size: 1.25rem;
}

.email-body p,
.letter-body p {
  margin-bottom: 1rem;
}

.email-body a,
.letter-body a {
  color: #007bff;
  text-decoration: none;
}

.email-body a:hover,
.letter-body a:hover {
  text-decoration: underline;
}

.email-body img,
.letter-body img {
  max-width: 100%;
  height: auto;
  border-radius: 4px;
  margin: 1.5rem 0;
}

.email-body ul,
.email-body ol,
.letter-body ul,
.letter-body ol {
  margin-bottom: 1rem;
  padding-left: 2rem;
}

.email-body li,
.letter-body li {
  margin-bottom: 0.5rem;
}

.email-body blockquote,
.letter-body blockquote {
  margin: 1.5rem 0;
  padding-left: 1rem;
  border-left: 4px solid #e9ecef;
  color: #666;
  font-style: italic;
}

.email-body code,
.letter-body code {
  background: #f8f9fa;
  padding: 0.2rem 0.4rem;
  border-radius: 3px;
  font-family: 'Courier New', monospace;
  font-size: 0.9em;
}

.email-body pre,
.letter-body pre {
  background: #f8f9fa;
  padding: 1rem;
  border-radius: 4px;
  overflow-x: auto;
  margin: 1.5rem 0;
}

.email-body pre code,
.letter-body pre code {
  background: none;
  padding: 0;
}

.email-body hr,
.letter-body hr {
  border: none;
  border-top: 2px solid #e9ecef;
  margin: 2rem 0;
}

/* PWA Banner */
.pwa-banner {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 1rem;
  border-radius: 8px;
  margin: 1rem 0 2rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 1rem;
  flex-wrap: wrap;
}

.pwa-banner-text {
  flex: 1;
  min-width: 200px;
}

.pwa-banner-text h3 {
  margin-bottom: 0.25rem;
  font-size: 1.1rem;
}

.pwa-banner-text p {
  font-size: 0.9rem;
  opacity: 0.9;
}

.btn-primary {
  background: #007bff;
  color: white;
  padding: 0.75rem 1.25rem;
  border: none;
  border-radius: 6px;
  font-size: 0.9375rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
}

.btn-primary:hover {
  background: #0056b3;
  transform: translateY(-1px);
}

.btn-primary:active {
  transform: translateY(0);
}

.btn-primary:disabled {
  background: #6c757d;
  cursor: not-allowed;
  transform: none;
}

.btn-danger {
  background: #dc3545;
  color: white;
  padding: 0.75rem 1.25rem;
  border: none;
  border-radius: 6px;
  font-size: 0.9375rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
}

.btn-danger:hover {
  background: #c82333;
  transform: translateY(-1px);
}

.btn-danger:active {
  transform: translateY(0);
}

/* Offline & PWA UI */
.offline-banner {
  background: #ff9800;
  color: white;
  padding: 0.75rem 1rem;
  text-align: center;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-weight: 500;
}

.download-progress {
  background: white;
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.download-progress-bar {
  height: 8px;
  background: #e9ecef;
  border-radius: 4px;
  overflow: hidden;
  margin-bottom: 0.5rem;
}

.download-progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #007bff, #0056b3);
  transition: width 0.3s ease;
}

.download-progress p {
  font-size: 0.875rem;
  color: #666;
  text-align: center;
  margin: 0;
}

.btn-offline {
  background: #6c757d;
  color: white;
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 6px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
  white-space: nowrap;
}

.btn-offline:hover {
  background: #5a6268;
  transform: translateY(-1px);
}

.btn-offline:active {
  transform: translateY(0);
}

.offline-panel {
  background: white;
  padding: 1.5rem;
  border-radius: 8px;
  margin-bottom: 1.5rem;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.offline-panel h3 {
  margin-bottom: 1rem;
  color: #1a1a1a;
  font-size: 1.25rem;
}

.offline-stats {
  background: #f8f9fa;
  padding: 1rem;
  border-radius: 6px;
  margin-bottom: 1rem;
}

.offline-stats p {
  margin: 0.5rem 0;
  color: #495057;
  font-size: 0.9375rem;
}

.offline-actions {
  display: flex;
  gap: 0.75rem;
  margin-bottom: 1rem;
  flex-wrap: wrap;
}

.offline-note {
  font-size: 0.875rem;
  color: #666;
  line-height: 1.5;
  margin: 0;
  font-style: italic;
}

/* Responsive Design */
@media (max-width: 768px) {
  .container {
    padding: 1rem 0.5rem;
  }

  .header h1 {
    font-size: 2rem;
  }

  .control-row {
    flex-direction: column;
    align-items: stretch;
  }

  .sort-container {
    width: 100%;
    justify-content: space-between;
  }

  .sort-select {
    flex: 1;
  }

  .result-count {
    text-align: center;
  }

  .btn-random {
    width: 100%;
  }

  .email-card-content {
    padding: 1rem;
  }

  .email-card h2 {
    font-size: 1.25rem;
  }

  .email-content,
  .letter-content {
    padding: 1.5rem 1rem;
  }

  .email-header h1,
  .letter-header h1 {
    font-size: 1.5rem;
  }

  .reader-nav,
  .navigation {
    flex-direction: column;
    align-items: stretch;
  }

  .nav-buttons,
  .nav-links {
    flex-direction: column;
  }

  .btn {
    width: 100%;
    text-align: center;
  }

  .btn-nav {
    font-size: 0.8125rem;
    white-space: normal;
    word-wrap: break-word;
  }

  body {
    padding: 10px;
  }

  .pwa-banner {
    flex-direction: column;
    text-align: center;
  }
}

@media (max-width: 480px) {
  .email-card-image {
    height: 150px;
  }

  .email-body,
  .letter-body {
    font-size: 1rem;
  }
}

    
    /* Static site specific adjustments */
    body {
      padding: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    
    <div class="pwa-banner" style="display: none;">
      <div class="pwa-banner-text">
        <h3>üì± Read Offline</h3>
        <p>Install the app to read all letters offline</p>
      </div>
      <div>
        <button class="btn btn-primary" onclick="installPWA()">Install App</button>
      </div>
    </div>

    <article class="letter-content">
      <header class="letter-header">
        <h1>thank you notes 1/13</h1>
        <time datetime="2016-01-13T00:00:00Z">January 12, 2016</time>
      </header>

      <div class="letter-body">
        <p>i&#39;m thankful for how crazy things have been this week with the students back on campus and the semester started and research projects restarted and tenure dossiers and cover letters in need of editing. i&#39;m thankful, even if i feel more exhausted than normal at the end of the day, because it also makes the day go faster (i&#39;m also thankful also for how it makes me better appreciate the times when i&#39;m less busy). i&#39;m thankful for the students, who, despite the way they&#39;re often caricatured in the media and popular culture as entitled and shallow and vapid, are generally sweet and kind and energetic, and who want to learn and do a good job and figure out who they want to be. i&#39;m thankful for the moment yesterday when i asked a lost-looking student in the hall if she needed directions and she did and i gave her directions and then literally six more students immediately came up to me to ask where other places in the building and on campus were. i&#39;m thankful that my action gave them that permission to stop feeling lost and ask me where they needed to go (a permission i would have definitely needed when i was a student) and i&#39;m thankful that i (mostly) knew where they needed to go. i&#39;m thankful for the feeling of having bearings in a place and thankful for the good sense of direction and navigation that i inherited from my mother.¬†</p>
<p>i&#39;m thankful even for the rare student who is an asshole, like the one who stood in front of my desk with a shit-eating &quot;serve me, peasant&quot; smirk and insisted on waiting there for me to email him a document before he would leave because he didn&#39;t trust me (his words) to email it to him if he walked away. i&#39;m thankful for the way that in such moments i imagine my smile as armor, like the shield that link holds up in zelda‚Äîi try to experience every unkind word or rude gesture as the tiny plink sound of an attack bouncing off of me and falling away, all my hearts intact. i&#39;m thankful also for the way that the occasional bad apple reminds me of the blessing of just how good most of them are, like the lost student who continuously thanked me as we toured the school trying to find her self defense class, which, after going down so many fluorescent-lit badly labeled hallways, we discovered was being held, unexpectedly, in a racquetball court. i&#39;m thankful for the generosity of hyperbole, like i received from the student who told me i was &quot;literally saving her life&quot; by printing out a copy of her resume for an internship application.</p>
<p>i&#39;m thankful for the tiny pineapple cakes that a visiting lecture brought back in her suitcase from a holiday trip to taiwan for me. i&#39;m thankful that the box they came in was beautifully printed with the photo-realistic yellow brown skin and green stalk of a real pineapple and for the way that the &quot;stalk&quot; at the top of the box was folded intricately to gesture towards the geometry of a real pineapple stalk. i&#39;m thankful for the dry pale shortbready crumbliness of the small round cakes inside, for the beautiful wastefulness of their individual plastic wrapping, for the delicate and subtle dab of pineapple preserve in the center of them. i&#39;m thankful for how nicely they paired with the vanilla porter i got at the grocery store and was drinking with dinner.¬†</p>
<p>i&#39;m thankful that over the holidays, i watched a stupid documentary on netflix about north korea. i&#39;m thankful, even though the documentary was stupid (i&#39;m thankful to recommend instead, if you&#39;re interested in the subject, two excellent books about north korea i read last year: <a href="http://www.amazon.com/Without-You-There-No-Us/dp/0307720667/ref=sr_1_6?ie=UTF8&qid=1452706013&sr=8-6&keywords=korea+memoir">1</a>, <a href="http://www.amazon.com/Kim-Jong-Il-Production-Extraordinary-Kidnapped/dp/1250054273/ref=sr_1_1?ie=UTF8&qid=1452706028&sr=8-1&keywords=kim+jong+il+film">2</a>), because thinking about the stupidity of the documentary revealed to me a vein of my own stupidity i had not yet tapped. i&#39;m thankful for how a brief discussion of taiwan in the documentary made me suddenly realize with shame that for all the time i&#39;ve known the taiwanese visiting lecturers here, which is years now, and for how they are some of my favorite people to work with and talk to and joke around with, i didn&#39;t know anything about taiwan except that the climate is hot and the capital is taipei and it one of three words in a label that was stamped on cheap plastic toys i owned as a child in the nineties. i&#39;m thankful to realize how i&#39;ve stupidly always operated in conversation with the visiting lecturers under some uninformed subconscious perception that taiwan was like, a wholly-owned subsidiary of china with maybe an aura of some kind of quasi-democratic/independent status like hong kong, when actually, it turns out, that&#39;s not really true and the government is completely independent, even if the question of statehood is¬†<a href="https://www.quora.com/Is-Taiwan-part-of-or-separate-from-China">complicated</a>. i&#39;m thankful to reckon with how the fact that i lived in (a completely different!) country in asia (for one year) and am married to a korean american woman (i&#39;m thankful for the time when she taught me not to use a hyphen) and like ramen and uniqlo and read a bit of the <em>new york times</em> on my phone¬†every morning does not actually make me an informed global citizen. i&#39;m thankful to know a little bit more now and to hope that in my conversations with the visiting lecturers i haven&#39;t said anything too egregiously stupid or offensive. i&#39;m thankful that they like me so they&#39;ve hopefully forgiven me if i did and thankful that i&#39;m able to have nice moments with them and offer to help them with cover letters and presentations and print orders and all the things i do know about.</p>
<p>i&#39;m thankful to try to be conscious of how i subconsciously other people so i can try my best not to do it. i&#39;m thankful for the ongoing banter that i have with the faculty member whose office is closest to my desk about how he eats his lunch so late (i&#39;m thankful that he eats it so late because he&#39;s so devoted to making time to meet with his students, even if he&#39;s having serious health issues that cause chronic pain and has four children with another coming and is also finishing his doctorate). i&#39;m thankful for the joke he made the other day, when heating up his lunch at 3:30pm, about how his new motto, inspired by &quot;it&#39;s 5 o&#39;clock somewhere,&quot; is &quot;it&#39;s noon somewhere.&quot; i&#39;m thankful for how briefly surprising i found the joke because he&#39;s a mormon, and then thankful at how i immediately had a meta-thought correcting myself about how of course him being a mormon doesn&#39;t, like, preclude him from participating in the culture and having at some point heard that dumb country song slogan about drinking.¬†</p>
<p>i&#39;m thankful for the first time i had this kind of double self-conscious reaction to his mormonism, last year when i was moving the mouse on his new computer every five minutes so that it wouldn&#39;t go to sleep while his box account synced. i&#39;m thankful that i made a reference to desmond and the computer on <em>lost</em> to describe how committed i would be to making sure his computer wouldn&#39;t go to sleep and he didn&#39;t seem to understand what i was saying and i&#39;m thankful i had the stupid thought that &quot;of course&quot; he didn&#39;t get the reference &quot;because he&#39;s mormon&quot; and then i repeated myself louder and he laughed in recognition and said that was one of his favorite shows of all time. i&#39;m thankful for <em>lost</em>, which i loved all of, even the ending (i&#39;m thankful for the ongoing semi-serious debate i have with d about whether a bad ending invalidates a good tv series, with me arguing that it doesn&#39;t, that from a formalist perspective, TV is essentially defined by its seriality, so it&#39;s more important that it&#39;s pleasurable and engaging from episode to episode over the course of a series even if an ending is reallly bad (like¬†<em>battlestar galactica</em>), and her finding that thread of argument not to be wholly satisfying, which is many people&#39;s totally valid reaction to purely formalist critiques).¬†</p>
<p>i&#39;m thankful that my work friend t came in while i was rambling through that digression in the last paragraph to say hi and thankful that when i asked her about the finite math class she just started taking to try to finish a degree she abandoned when she was younger and wilder, she described how weird it was to be so much older than the other students in her class (&quot;i realized that i&#39;m probably seventeen years years older than most of them‚Äîi&#39;m basically a whole them older than them&quot;) ¬†but how she felt positive about the choice to take the class and how much better of a learner she feels like she is because of her age and knowing herself better than she did when she was &quot;college age.&quot; i&#39;m thankful for how, changing the subject, we were talking about how it was 1 degree this morning but at least there was no wind-chill and how she said that her friend who is canadian came over the previous night and, over bourbon, taught her how to rap. i&#39;m thankful for her laughter when i gave her a perplexed look and said &quot;what?&quot; and that she made clear that she meant how to wrap two scarves around her head and neck to stay warmer in the cold wind and i said &quot;oh, that makes sense, because i was like...canadians aren&#39;t known for their rapping&quot; and she said &quot;yeah, canadians are not rappers&quot; and we laughed. i&#39;m thankful for the chance to apologize here to drake.</p>

      </div>
    </article>

    <nav class="navigation">
      <a href="/letters/" class="btn btn-secondary">home</a>
      <div class="nav-links">
        <a href="/letters/letters/thank-you-notes-l-9611.html" class="btn btn-secondary">‚Üê thank you notes (L)</a>
        <a href="/letters/letters/thank-you-notes-112-6186.html" class="btn btn-secondary">thank you notes 1/12 ‚Üí</a>
      </div>
    </nav>
  
  </div>

  <script>
    // PWA installation prompt
    let deferredPrompt;

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      
      const banner = document.querySelector('.pwa-banner');
      if (banner) {
        banner.style.display = 'flex';
      }
    });

    async function installPWA() {
      if (!deferredPrompt) {
        // If not installable, redirect to PWA
        window.location.href = '/letters/app/';
        return;
      }

      deferredPrompt.prompt();
      const { outcome } = await deferredPrompt.userChoice;
      
      if (outcome === 'accepted') {
        console.log('PWA installed');
      }
      
      deferredPrompt = null;
      const banner = document.querySelector('.pwa-banner');
      if (banner) {
        banner.style.display = 'none';
      }
    }

    function openPWA() {
      window.location.href = '/letters/app/';
    }

    // Progressive Enhancement: Check if user has PWA installed
    // If they do, redirect them to the app version for a richer experience
    if (window.matchMedia('(display-mode: standalone)').matches) {
      // User is in standalone mode (PWA is installed and running)
      // Keep them on static page - they're already in PWA mode
      console.log('Running in PWA mode');
    } else {
      // Check if user has previously used the PWA (has cached data)
      if ('caches' in window) {
        caches.keys().then(cacheNames => {
          const hasPWACache = cacheNames.some(name => 
            name.includes('static-') || name.includes('data-')
          );
          
          // Only show PWA banner if they have cached content
          if (hasPWACache) {
            const banner = document.querySelector('.pwa-banner');
            if (banner && banner.style.display === 'none') {
              banner.style.display = 'flex';
            }
          }
        });
      }
    }

    // Register service worker for all pages
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker
          .register('/letters/sw.js', { scope: '/letters/' })
          .then((registration) => {
            console.log('SW registered:', registration);
          })
          .catch((error) => {
            console.log('SW registration failed:', error);
          });
      });
    }
  </script>
</body>
</html>