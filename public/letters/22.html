<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="2/2">
  <title>2/2 - Thank You Notes</title>
  <link rel="manifest" href="/letters/manifest.json">
  <meta name="theme-color" content="#007bff">
  <link rel="apple-touch-icon" href="/letters/icon-192.png">
  <style>
    /**
 * Shared Styles for Thank You Notes
 * Used by both the static site and PWA version
 */

/* Base Reset and Layout */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  background: #f5f5f5;
  color: #333;
  line-height: 1.6;
}

.container {
  max-width: 900px;
  margin: 0 auto;
  padding: 2rem 1rem;
}

/* Loading and Error States */
.loading,
.error {
  text-align: center;
  padding: 3rem;
  font-size: 1.2rem;
}

.error {
  color: #dc3545;
}

/* Header */
.header {
  margin-bottom: 1.5rem;
  text-align: center;
}

.header h1 {
  font-size: 2.5rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  color: #1a1a1a;
}

.subtitle {
  font-size: 1rem;
  color: #666;
}

/* Controls */
.controls {
  margin-bottom: 2rem;
}

.search-container {
  position: relative;
  margin-bottom: 1rem;
}

.search-input {
  width: 100%;
  padding: 0.75rem 2.5rem 0.75rem 1rem;
  font-size: 1rem;
  border: 2px solid #dee2e6;
  border-radius: 8px;
  outline: none;
  transition: border-color 0.2s;
  background: white;
}

.search-input:focus {
  border-color: #007bff;
}

.clear-search {
  position: absolute;
  right: 0.75rem;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  font-size: 1.25rem;
  color: #6c757d;
  cursor: pointer;
  padding: 0.25rem 0.5rem;
  line-height: 1;
  transition: color 0.2s;
}

.clear-search:hover {
  color: #333;
}

.control-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 1rem;
  flex-wrap: wrap;
}

.sort-container {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.sort-container label {
  font-size: 0.875rem;
  font-weight: 500;
  color: #666;
}

.sort-select {
  padding: 0.5rem 0.75rem;
  font-size: 0.875rem;
  border: 2px solid #dee2e6;
  border-radius: 6px;
  background: white;
  cursor: pointer;
  outline: none;
  transition: border-color 0.2s;
}

.sort-select:focus {
  border-color: #007bff;
}

.result-count {
  font-size: 0.875rem;
  font-weight: 600;
  color: #495057;
  padding: 0.5rem 0.75rem;
  background: #e9ecef;
  border-radius: 6px;
  white-space: nowrap;
}

.btn-random {
  background: #28a745;
  color: white;
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 6px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
  white-space: nowrap;
}

.btn-random:hover {
  background: #218838;
  transform: translateY(-1px);
}

.btn-random:active {
  transform: translateY(0);
}

.searching,
.no-results {
  text-align: center;
  padding: 3rem 1rem;
  font-size: 1.1rem;
  color: #666;
}

/* Email/Letter List */
.list,
.letter-list {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

.email-card,
.letter-card {
  background: white;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  cursor: pointer;
  transition: transform 0.2s, box-shadow 0.2s;
  text-decoration: none;
  color: inherit;
  display: block;
}

.email-card:hover,
.letter-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.email-card-image {
  width: 100%;
  height: 200px;
  overflow: hidden;
  background: #e9ecef;
}

.email-card-image img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.email-card-content,
.letter-card {
  padding: 1.5rem;
}

.email-card h2,
.letter-card h2 {
  font-size: 1.5rem;
  margin-bottom: 0.5rem;
  color: #1a1a1a;
  font-weight: 600;
}

.email-description,
.letter-card p {
  color: #666;
  margin-bottom: 0.75rem;
  line-height: 1.5;
}

.email-search-snippet {
  color: #555;
  margin-bottom: 0.75rem;
  line-height: 1.5;
  font-style: italic;
}

.search-highlight {
  background: #fff3cd;
  color: #856404;
  font-weight: 700;
  padding: 0.1rem 0.2rem;
  border-radius: 3px;
  font-style: normal;
}

.email-date,
.letter-card time {
  display: block;
  font-size: 0.875rem;
  color: #888;
}

/* Email/Letter Reader */
.email-reader,
.letter-content {
  background: white;
  border-radius: 8px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  overflow: hidden;
  margin-bottom: 2rem;
}

.email-reader {
  touch-action: pan-y pinch-zoom;
}

.reader-nav,
.navigation {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem 1.5rem;
  background: #f8f9fa;
  border-bottom: 1px solid #dee2e6;
  gap: 1rem;
  flex-wrap: wrap;
}

.reader-nav-bottom {
  border-top: 1px solid #dee2e6;
  border-bottom: none;
}

.nav-buttons,
.nav-links {
  display: flex;
  gap: 0.5rem;
  flex-wrap: wrap;
}

/* Buttons */
.btn {
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 4px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
  text-decoration: none;
  display: inline-block;
}

.btn:hover {
  transform: translateY(-1px);
}

.btn:active {
  transform: translateY(0);
}

.btn-secondary {
  background: #6c757d;
  color: white;
}

.btn-secondary:hover {
  background: #5a6268;
}

.btn-nav {
  background: #007bff;
  color: white;
}

.btn-nav:hover {
  background: #0056b3;
}

.btn-back-arrow {
  background: none;
  border: none;
  color: #333;
  cursor: pointer;
  padding: 0.25rem 0.5rem;
  transition: color 0.2s, transform 0.1s;
  line-height: 1;
}

.btn-back-arrow:hover {
  color: #007bff;
  transform: translateX(-2px);
}

.btn-back-arrow:active {
  transform: translateX(0);
}

/* Email/Letter Content */
.email-content,
.letter-content {
  padding: 2rem 1.5rem;
}

.email-header,
.letter-header {
  margin-bottom: 2rem;
  padding-bottom: 1.5rem;
  border-bottom: 2px solid #e9ecef;
}

.email-header h1,
.letter-header h1 {
  font-size: 2rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  color: #1a1a1a;
  line-height: 1.3;
}

.email-header .email-date,
.letter-header time {
  font-size: 1rem;
  color: #666;
}

/* Email/Letter Body Styles */
.email-body,
.letter-body {
  font-size: 1.0625rem;
  line-height: 1.7;
  color: #333;
}

.email-body h1,
.email-body h2,
.email-body h3,
.email-body h4,
.email-body h5,
.email-body h6,
.letter-body h1,
.letter-body h2,
.letter-body h3,
.letter-body h4,
.letter-body h5,
.letter-body h6 {
  margin-top: 1.5rem;
  margin-bottom: 0.75rem;
  font-weight: 600;
  color: #1a1a1a;
  line-height: 1.3;
}

.email-body h1,
.letter-body h1 {
  font-size: 1.875rem;
}

.email-body h2,
.letter-body h2 {
  font-size: 1.5rem;
}

.email-body h3,
.letter-body h3 {
  font-size: 1.25rem;
}

.email-body p,
.letter-body p {
  margin-bottom: 1rem;
}

.email-body a,
.letter-body a {
  color: #007bff;
  text-decoration: none;
}

.email-body a:hover,
.letter-body a:hover {
  text-decoration: underline;
}

.email-body img,
.letter-body img {
  max-width: 100%;
  height: auto;
  border-radius: 4px;
  margin: 1.5rem 0;
}

.email-body ul,
.email-body ol,
.letter-body ul,
.letter-body ol {
  margin-bottom: 1rem;
  padding-left: 2rem;
}

.email-body li,
.letter-body li {
  margin-bottom: 0.5rem;
}

.email-body blockquote,
.letter-body blockquote {
  margin: 1.5rem 0;
  padding-left: 1rem;
  border-left: 4px solid #e9ecef;
  color: #666;
  font-style: italic;
}

.email-body code,
.letter-body code {
  background: #f8f9fa;
  padding: 0.2rem 0.4rem;
  border-radius: 3px;
  font-family: 'Courier New', monospace;
  font-size: 0.9em;
}

.email-body pre,
.letter-body pre {
  background: #f8f9fa;
  padding: 1rem;
  border-radius: 4px;
  overflow-x: auto;
  margin: 1.5rem 0;
}

.email-body pre code,
.letter-body pre code {
  background: none;
  padding: 0;
}

.email-body hr,
.letter-body hr {
  border: none;
  border-top: 2px solid #e9ecef;
  margin: 2rem 0;
}

/* PWA Banner */
.pwa-banner {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 1rem;
  border-radius: 8px;
  margin: 1rem 0 2rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 1rem;
  flex-wrap: wrap;
}

.pwa-banner-text {
  flex: 1;
  min-width: 200px;
}

.pwa-banner-text h3 {
  margin-bottom: 0.25rem;
  font-size: 1.1rem;
}

.pwa-banner-text p {
  font-size: 0.9rem;
  opacity: 0.9;
}

.btn-primary {
  background: #007bff;
  color: white;
  padding: 0.75rem 1.25rem;
  border: none;
  border-radius: 6px;
  font-size: 0.9375rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
}

.btn-primary:hover {
  background: #0056b3;
  transform: translateY(-1px);
}

.btn-primary:active {
  transform: translateY(0);
}

.btn-primary:disabled {
  background: #6c757d;
  cursor: not-allowed;
  transform: none;
}

.btn-danger {
  background: #dc3545;
  color: white;
  padding: 0.75rem 1.25rem;
  border: none;
  border-radius: 6px;
  font-size: 0.9375rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
}

.btn-danger:hover {
  background: #c82333;
  transform: translateY(-1px);
}

.btn-danger:active {
  transform: translateY(0);
}

/* Offline & PWA UI */
.offline-banner {
  background: #ff9800;
  color: white;
  padding: 0.75rem 1rem;
  text-align: center;
  border-radius: 8px;
  margin-bottom: 1rem;
  font-weight: 500;
}

.download-progress {
  background: white;
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.download-progress-bar {
  height: 8px;
  background: #e9ecef;
  border-radius: 4px;
  overflow: hidden;
  margin-bottom: 0.5rem;
}

.download-progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #007bff, #0056b3);
  transition: width 0.3s ease;
}

.download-progress p {
  font-size: 0.875rem;
  color: #666;
  text-align: center;
  margin: 0;
}

.btn-offline {
  background: #6c757d;
  color: white;
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 6px;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
  white-space: nowrap;
}

.btn-offline:hover {
  background: #5a6268;
  transform: translateY(-1px);
}

.btn-offline:active {
  transform: translateY(0);
}

.offline-panel {
  background: white;
  padding: 1.5rem;
  border-radius: 8px;
  margin-bottom: 1.5rem;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.offline-panel h3 {
  margin-bottom: 1rem;
  color: #1a1a1a;
  font-size: 1.25rem;
}

.offline-stats {
  background: #f8f9fa;
  padding: 1rem;
  border-radius: 6px;
  margin-bottom: 1rem;
}

.offline-stats p {
  margin: 0.5rem 0;
  color: #495057;
  font-size: 0.9375rem;
}

.offline-actions {
  display: flex;
  gap: 0.75rem;
  margin-bottom: 1rem;
  flex-wrap: wrap;
}

.offline-note {
  font-size: 0.875rem;
  color: #666;
  line-height: 1.5;
  margin: 0;
  font-style: italic;
}

/* Responsive Design */
@media (max-width: 768px) {
  .container {
    padding: 1rem 0.5rem;
  }

  .header h1 {
    font-size: 2rem;
  }

  .control-row {
    flex-direction: column;
    align-items: stretch;
  }

  .sort-container {
    width: 100%;
    justify-content: space-between;
  }

  .sort-select {
    flex: 1;
  }

  .result-count {
    text-align: center;
  }

  .btn-random {
    width: 100%;
  }

  .email-card-content {
    padding: 1rem;
  }

  .email-card h2 {
    font-size: 1.25rem;
  }

  .email-content,
  .letter-content {
    padding: 1.5rem 1rem;
  }

  .email-header h1,
  .letter-header h1 {
    font-size: 1.5rem;
  }

  .reader-nav,
  .navigation {
    flex-direction: column;
    align-items: stretch;
  }

  .nav-buttons,
  .nav-links {
    flex-direction: column;
  }

  .btn {
    width: 100%;
    text-align: center;
  }

  .btn-nav {
    font-size: 0.8125rem;
    white-space: normal;
    word-wrap: break-word;
  }

  body {
    padding: 10px;
  }

  .pwa-banner {
    flex-direction: column;
    text-align: center;
  }
}

@media (max-width: 480px) {
  .email-card-image {
    height: 150px;
  }

  .email-body,
  .letter-body {
    font-size: 1rem;
  }
}


    
    /* Static site specific adjustments */
    body {
      padding: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    
    <div class="pwa-banner" style="display: none;">
      <div class="pwa-banner-text">
        <h3>📱 Read Offline</h3>
        <p>Install the app to read all letters offline</p>
      </div>
      <div>
        <button class="btn btn-primary" onclick="installPWA()">Install App</button>
      </div>
    </div>

    <article class="letter-content">
      <header class="letter-header">
        <h1>2/2</h1>
        <time datetime="2017-02-02T00:00:00Z">February 1, 2017</time>
      </header>

      <div class="letter-body">
        <p>i&#39;m thankful to have gone out with our friends last night, even though i didn&#39;t want to. i&#39;m thankful that though i was upset that i had misremembered the time and made us go to the bar a half hour early, that was also good because we were able to get a table in the quieter part of the back of the bar which we probably wouldn&#39;t have been able to get if we had just been &quot;on time.&quot; i&#39;m thankful for <a href="https://untappd.com/b/the-tap-brewery-gingerbeer-d-man/1832269">the beer i got,</a> which came in a glass rimmed with cinnamon sugar (i&#39;m thankful for cinnamon sugar, which is a heavenly substance that improves most things). i&#39;m thankful that d noticed that the glass was can shaped and we were wondering what the fancy name for that kind of glass is, since all specialty beer glasses have some kind of fancy name, or so we thought because actually she was right the first time and it&#39;s called <a href="https://www.google.com/webhp?sourceid=chrome-instant&ion=1&espv=2&ie=UTF-8#q=can+shaped+glass&start=10">a can-shaped glass</a>. i&#39;m thankful for when the names for things are lazy and prosaic.</p>
<p>i&#39;m thankful that my beer was tasty, even if during dinner (i couldn&#39;t finish my sandwich) after dinner and through the night i regretted drinking two of them. i&#39;m thankful to have gotten further evidence that at this period of my life, the negative side effects of drinking outweigh the positive ones. i&#39;m thankful to know this and remind myself of this when i am given the opportunity to drink in the future. i&#39;m thankful for water, flat and sparkling. i&#39;m thankful to try to remember life before everyone carried around water bottles all the time and to wonder how people weren&#39;t constantly massively dehydrated. i&#39;m thankful to know that maybe what i feel at thirst at times is socially constructed, is in my head because it&#39;s in the culture rather than me actually needing more water. i&#39;m thankful that i don&#39;t have to test this hypothesis because i have water when i need it.</p>
<p>i&#39;m thankful to have thought about the time before water bottles because of a sentence in nicholson baker&#39;s book <em>substitute</em> about the items allowed on students desks in a fifth grade classroom where he was substitute teaching. i&#39;m very thankful for the book, which is full of paragraphs like this:</p>
<p>&quot;<em>Here&#39;s what was going on in their weekend lives. JoBeth was learning to balance a sword on her head like her mom: &quot;It&#39;s fun, but you have to be very careful, or you&#39;ll get stabbed badly.&quot; Danielle went to a monster truck rally and almost got a splatball egg at the mall. Sara made some origami figures. Nicole, Rory, and Troy played Minecraft; Nicole said there was a weird stalker guy following her around in the game. Carlton worked with his dad on his pinewood derby car. Nash raced in a pinewood derby and came in second twice but seventh overall. Zeke said he was going to go to monster trucks with his dad, but his dad said it was sixty dollars just to get in the front door, so his dad looked up the Harlem Globetrotters, and tickets for them cost 300 dollars, so he took them to The Lego Movie instead, and then after the movie they were going to go to the gun show but they didn&#39;t. Zoe was going to get a new iPod but didn&#39;t. Toby ate a ham sandwich. Pauline, who was shy, went to the science museum to celebrate her brother&#39;s birthday, and a scientist rubbed a balloon on her head. Larissa was FaceTimed by two boys from class and then she whittled a stick with a knife for twenty minutes. Jess picked up her dog&#39;s ashes—she still missed him—and she slept over at her friend&#39;s and FaceTimed with two boys from class. Amber L. went to the doctor to be tested for strep throat and then went to her aunt&#39;s house and then she rode her bike with her brother. Amber S. got a new bike and learned that the Girl Scouts have sold more than a million boxes of cookies in the state of Maine. Ian went swimming at the YMCA. Ethan started to write a book about a girl who uncovers secrets about her family and brings an evil creature to life, and then he decorated a cake with a whale for his mom&#39;s boyfriend, and afterward he learned that cake decorating was in his family on both sides: &#39;I have cake decorating in my blood basically,&#39; he said. Amanda said the stove in her house caught fire and her brother helped her get out of the house. Nadia said she made a tunnel in a snowbank that was big enough that she could turn around inside it</em>.&quot;</p>
<p>i&#39;m thankful at times such as this to nuzzle into the comforts of the quotidian. i&#39;m thankful for the book and for <a href="http://danaanm.tumblr.com/post/156637538003/thank-you-notes-31st-january">dana&#39;s thank you notes</a> (i&#39;m thankful that dana really likes her new job even though she has to wake up at 5am), which remind me of things about teaching ESL in korea and creative writing and english comp during grad school. i&#39;m thankful to remember how in korea our classrooms were named after ivy league schools and that i taught first in &quot;harvard&quot; and then settled in &quot;oxford.&quot; i&#39;m thankful to remember that oxford had glass walls, so you could see into the hallway, and i&#39;m thankful to remember a game where i would hide behind my desk and then pop out when a student appeared on the other side of the glass wall, causing a scream of fear and glee, and then chase the student down the hall and go back to my desk and start the whole cycle again. i&#39;m thankful to remember the flash game <a href="http://armorgames.com/play/1760/hedgehog-launch">hedgehog launch</a>, which the younger students and i would play projected onto the whiteboard. i&#39;m thankful to remember a private tutorial where a high school student and i took turn readings john krakauer&#39;s <em>into thin air</em> to each other and i&#39;m thankful that he had horrible breath and i got into the habit of carrying gum to offer him, which made both of us happier. i&#39;m thankful for h, s, and j, who were my gifted second grade class and who cried and made me cards on my last day of work and had to come back from their other classes later in the day to hug me again. i&#39;m thankful to have written about another nice moment in an essay at the time, which will help me keep from forgetting it:</p>
<p>&quot;<em><a href="https://songsaboutbuildingsandfood.wordpress.com/2009/01/13/dancing-wrt-architecture/">so anyway</a>, the students liked the new yorker article and maybe learned something and maybe didn’t and whatever, i am not jaime escalante and this was not october sky.  after we finished reading the article, we killed some time playing a flash game on the classroom’s big projection screen and then class ended at 10.  we all packed up our stuff and headed out, me immaturely leading the charge to get the hell out of the academy.  despite my rush, the class had been really good that day and there was this kind of buzzy energy in the air.  as we were standing around waiting for the elevators to come, one of my students asked me what day christmas was.  i thought this was kind of a strange question but then a lot of my students, especially the teenage boys, were avowed atheists (also i hadn’t had anything but green tea in like 8 hours so my blood sugar was pretty low). “um, december 25th?” i said.  the students who were around me laughed and the kid said, “no, what day?”  “oh,” i said, “thursday.”  our class met on tuesdays and thursdays — the next thursday was christmas day.  the student then asked if we were going to have class on christmas and i told him no.</em></p>
<p><em>“oh darn,” he said, and i looked at him, waiting for the haha, the “just kidding,” the “gotcha”  — we’d worked a lot on comic timing and sarcasm (important academic subjects) in class.  but he didn’t do anything, he just stood there, looking back at me.  just after he said “oh darn,” another kid who was standing with us said,  “yeah, too bad,” and again, no laugh, no irony, no tone, not even a change in his facial expression.  that was it, there was no saccharine string motif or close-up to signify it, but that was it.  these kids, who go to school six if not seven days a week from eight in the morning until ten at night, they were saying they would rather come and have class with me than have the day off for christmas.</em>&quot;</p>
<p>i&#39;m thankful for <a href="http://tinyletter.com/Emily_Gould/letters/airplane">this letter about reading something difficult</a> to a child. i&#39;m thankful for <a href="https://www.youtube.com/watch?v=Ep3jK1bZrB8">five ways to comfort a kitten</a>. i&#39;m thankful to have been experimenting with taurine supplements as a way to calm myself down. i&#39;m thankful that i practiced bass for a little while yesterday; i&#39;m thankful that i have been resistant to practicing outside rehearsal, which feels too much like homework, but i&#39;m thankful to know that it&#39;s good to practice some if i can make myself. i&#39;m thankful for <a href="https://www.youtube.com/watch?v=65gqX2QhVRA">this first-person video of a chef who is blind cooking</a>. i&#39;m thankful for <a href="https://www.instagram.com/p/BP-hK1DloZl/?taken-by=lanadelrey&hl=en">lana del rey</a>. i&#39;m thankful for <a href="https://twitter.com/RitaByci/status/825452262277410816">bodyguard confusion</a>. i&#39;m thankful for <a href="https://www.theatlantic.com/science/archive/2017/02/why-frog-tongues-are-so-sticky/515193/">frog tongues</a>, which are &quot;<em>among the softest biological substances ever measured</em>.&quot;</p>

      </div>
    </article>

    <nav class="navigation">
      <a href="/letters/" class="btn btn-secondary">home</a>
      <div class="nav-links">
        <a href="/letters/letters/23-9884.html" class="btn btn-secondary">← 2/3</a>
        <a href="/letters/letters/21-4838.html" class="btn btn-secondary">2/1 →</a>
      </div>
    </nav>
  
  </div>

  <script>
    // PWA installation prompt
    let deferredPrompt;

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      
      const banner = document.querySelector('.pwa-banner');
      if (banner) {
        banner.style.display = 'flex';
      }
    });

    async function installPWA() {
      if (!deferredPrompt) {
        // If not installable, redirect to PWA
        window.location.href = '/letters/app/';
        return;
      }

      deferredPrompt.prompt();
      const { outcome } = await deferredPrompt.userChoice;
      
      if (outcome === 'accepted') {
        console.log('PWA installed');
      }
      
      deferredPrompt = null;
      const banner = document.querySelector('.pwa-banner');
      if (banner) {
        banner.style.display = 'none';
      }
    }

    function openPWA() {
      window.location.href = '/letters/app/';
    }

    // Progressive Enhancement: Check if user has PWA installed
    // If they do, redirect them to the app version for a richer experience
    if (window.matchMedia('(display-mode: standalone)').matches) {
      // User is in standalone mode (PWA is installed and running)
      // Keep them on static page - they're already in PWA mode
      console.log('Running in PWA mode');
    } else {
      // Check if user has previously used the PWA (has cached data)
      if ('caches' in window) {
        caches.keys().then(cacheNames => {
          const hasPWACache = cacheNames.some(name => 
            name.includes('static-') || name.includes('data-')
          );
          
          // Only show PWA banner if they have cached content
          if (hasPWACache) {
            const banner = document.querySelector('.pwa-banner');
            if (banner && banner.style.display === 'none') {
              banner.style.display = 'flex';
            }
          }
        });
      }
    }

    // Register service worker for all pages
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker
          .register('/letters/sw.js', { scope: '/letters/' })
          .then((registration) => {
            console.log('SW registered:', registration);
          })
          .catch((error) => {
            console.log('SW registration failed:', error);
          });
      });
    }
  </script>
</body>
</html>